import{d as U,a as D,r as g,u as R,o as $,x as B,s as H,c as i,f as c,g as a,F,y as z,k as E,j as A,z as V,w as S,n as j,t as I,h as O,p as Q,q as G,_ as J}from"./index-9d180844.js";import{u as K,a as W}from"./useAuth.vue_vue_type_script_lang-345c5324.js";import{P as X,R as Y,_ as Z,b as ee,d as te,g as oe,c as se}from"./index.esm2017-b1be84ac.js";import{u as ne}from"./useUserDetails.vue_vue_type_script_lang-331a5968.js";import{a as ae}from"./axios-4a70c6fc.js";import{u as re}from"./useDetailButtons-3c685b48.js";import{c as le}from"./useCalculateTime.vue_vue_type_script_lang-ca052a8e.js";const ie=p=>(Q("data-v-4464e637"),p=p(),G(),p),ce={key:0,id:"warningShow"},ue={key:1,class:"bookmarksPage"},de=ie(()=>a("h2",null,"Bookmarks",-1)),me={class:"bookmarksCon"},he={key:0,class:V({resultsContainer:!0})},pe=["onClick"],ye={class:"result-item-other"},fe={class:"result-item-header"},ve=["onClick"],ge=["innerHTML","onClick"],_e={key:1,class:"noBookmarks"},ke=U({__name:"BookMarks",setup(p){ne(),D(()=>{const e=document.getElementById("warningShow");e.style.display="none"});const u=g(""),C=new DOMParser,{app:M}=K(),d=W();d.sidebar=!1;const b=X(M),_=R(),y=g(!0),m=g([]),f=g();$(()=>{B(()=>{const e=document.getElementById("warningShow");e&&(e.style.display="flex",e.textContent="Loading ...")}),L(d.signedUser.bookmarks)}),H(()=>{d.signedUser.bookmarks.length===0&&(m.value=[])});function T(e){_.push(`/post/${e}`)}function P(e){if(e===d.signedUser.id)return _.push("/userProfile");_.push(`/chatterUser/${e}`)}async function q(e){u.value="";try{const s=e.postContain;await ae.post("/postContent",{contentUrl:s}).then(o=>{const t=C.parseFromString(o.data,"text/html");u.value=t.body.innerHTML}).catch(o=>{console.log(o)})}catch{const o=document.querySelector("#ErrorShow span");document.querySelector("#ErrorShow").style.display="flex",o.textContent="Something went wrong, check your internet connection"}}async function N(e){f.value=null;try{const s=oe(b,"users",e),o=await se(s);if(o.data()!==void 0){const{fullName:t,profilePicture:n,username:r,blogName:k}=o.data(),l={profilePicture:n,posterID:e,fullName:t,username:r,blogName:k};f.value={id:e,img:l.profilePicture,fullName:l.fullName,username:l.username,blogname:l.blogName}}}catch{}}async function L(e){try{const s=e.map(async n=>{const r=Y(Z(b,"posts"),ee("postId","==",n)),k=await te(r);return Promise.all(k.docs.map(async l=>{var x;const h=l.data();await q(h);const v=C.parseFromString(u.value,"text/html");return v.body.querySelectorAll("img").forEach(w=>{w.remove()}),v.body.querySelectorAll("video").forEach(w=>{w.remove()}),(x=v.body.querySelector("h1"))==null||x.remove(),u.value=v.body.innerHTML,h.postContain=u.value,await N(h.posterId),h.posterDetails=f.value,f.value=null,h}))}),t=(await Promise.all(s)).flat();m.value=t,y.value=!1,m.value&&B(()=>{const n=document.getElementById("warningShow");n&&(n.style.display="none")})}catch(s){console.log(s);const o=document.querySelector("#ErrorShow span");document.querySelector("#ErrorShow").style.display="flex",o.textContent="Something went wrong, check your internet connection"}}return(e,s)=>{var o;return y.value?(i(),c("div",ce)):(i(),c("section",ue,[de,a("div",me,[((o=m.value)==null?void 0:o.length)>0&&y.value===!1?(i(),c("div",he,[(i(!0),c(F,null,z(m.value,(t,n)=>(i(),c("div",{key:n,class:"result-item"},[a("div",{class:"imgCon",onClick:S(r=>P(t.posterId),["prevent"]),style:j({backgroundImage:`url(${t==null?void 0:t.posterDetails.img})`})},null,12,pe),a("div",ye,[a("div",fe,[a("span",{onClick:S(r=>P(t.posterId),["prevent"])},I(t==null?void 0:t.posterDetails.blogname),9,ve),a("span",null,I(le(t.postTime.seconds)),1)]),a("div",{innerHTML:t.postContain,id:"divContent",onClick:S(r=>T(t.postId),["prevent"])},null,8,ge),O(re,{post:t},null,8,["post"])])]))),128))])):E("",!0),A(d).signedUser.bookmarks.length===0&&y.value===!1?(i(),c("div",_e," No Bookmarks yet. ")):E("",!0)])]))}}});const Ee=J(ke,[["__scopeId","data-v-4464e637"]]);export{Ee as default};
