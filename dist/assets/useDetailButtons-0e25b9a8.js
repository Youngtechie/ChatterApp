import{d as M,o as j,c as B,f as x,w as A,j as U,A as R,q as E,s as q,g as s,r as Q,u as Z,h as V,t as z}from"./index-d9c4c67e.js";import{u as G,a as I}from"./useAuth.vue_vue_type_script_lang-77171506.js";import{P as Y,R as f,b as g,_ as v,I as F,d as P,a as h,g as u,c as O}from"./index.esm2017-7370a789.js";import{_ as D}from"./_plugin-vue_export-helper-c27b6911.js";const N=r=>(E("data-v-6bc22f3f"),r=r(),q(),r),T=["id"],J=N(()=>s("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 25 25",width:"15",height:"15"},[s("path",{"stroke-width":"2",d:"M12.5,4.17C7.71,0,0,3.92,0,8.75c0,4.61,3.9,8.35,12.5,16.25C20.1,17.1,24,13.36,24,8.75C24,3.92,16.29,0,12.5,4.17z"})],-1)),K=N(()=>s("span",null,"0",-1)),W=[J,K],X=M({__name:"useLikeButton",props:{viewPostId:String,viewPostPosterId:String},setup(r){const a=r,{app:$}=G(),i=Y($),k=I(),b=f(v(i,"posts"),g("postId","==",`${a.viewPostId}`));j(()=>{try{F(b,l=>{const t=l.docs[0].data();t!=null&&t.length!==0&&(t.postLikes.ids.includes(k.signedUser.id)?(document.querySelectorAll(`#btnLike${a.viewPostId} svg path`).forEach(e=>{e.style.fill="red"}),document.querySelectorAll(`#btnLike${a.viewPostId} span`).forEach(e=>{e.textContent=`${t.postLikes.total}`})):t.postLikes.ids.includes(k.signedUser.id)||(document.querySelectorAll(`#btnLike${a.viewPostId} svg path`).forEach(e=>{e.style.fill="none"}),document.querySelectorAll(`#btnLike${a.viewPostId} span`).forEach(e=>{e.textContent=`${t.postLikes.total}`})))})}catch{}});async function y(l,t,e){if(l===""||l===void 0)confirm("You need to be signed in to like a post. Do you want to sign in?")===!0&&R.push("/login");else{document.getElementById(`btnLike${t}`).setAttribute("disabled","true");const o=f(v(i,"users"),g("id","==",`${l}`)),p=f(v(i,"posts"),g("postId","==",`${t}`)),L=f(v(i,"users"),g("id","==",`${e}`));try{P(o).then(C=>{const n=C.docs[0].data();P(p).then(S=>{const d=S.docs[0].data();P(L).then(_=>{const m=_.docs[0].data();n!=null&&n.length!==0&&d!==void 0&&d!==null&&d.length!==0&&m!==void 0&&m!==null&&m.length!==0&&(n.likes.out.some(c=>c.postid===t)?h(u(i,"users",`${l}`),{["likes.out"]:n.likes.out.filter(c=>c.postid!==t),["likes.total.out"]:n.likes.total.out-1,activityLog:[...n.activityLog,{type:"You unliked this post",details:{postId:t,time:new Date}}],interactions:n.interactions.filter(c=>c.type==="Liked a post"&&c.details.postid===t)}):h(u(i,"users",`${l}`),{["likes.out"]:[...n.likes.out,{postid:t,time:new Date}],["likes.total.out"]:n.likes.total.out+1,activityLog:[...n.activityLog,{type:"You liked this post",details:{postId:t,time:new Date}}],interactions:[...n.interactions,{type:"Liked this post",details:{postid:t,time:new Date}}]}),d.postLikes.ids.some(c=>c===l)?h(u(i,"posts",`${t}`),{["postLikes.ids"]:d.postLikes.ids.filter(c=>c!==l),["postLikes.total"]:d.postLikes.total-1}):h(u(i,"posts",`${t}`),{["postLikes.ids"]:[...d.postLikes.ids,l],["postLikes.total"]:d.postLikes.total+1}),m.likes.in.some(c=>c.postid===t)?h(u(i,"users",`${e}`),{["likes.in"]:m.likes.in.filter(c=>c.postid!==t),["likes.total.in"]:m.likes.total.in-1}):e===l?h(u(i,"users",`${e}`),{["likes.in"]:[...m.likes.in,{postid:t,time:new Date}],["likes.total.in"]:m.likes.total.in+1}):h(u(i,"users",`${e}`),{["likes.in"]:[...m.likes.in,{postid:t,time:new Date}],["likes.total.in"]:m.likes.total.in+1,notifications:[...m.notifications,{type:`You got a like from <b>${n.fullName}</b> on a post`,details:{postId:t,time:new Date}}]}),document.getElementById(`btnLike${t}`).removeAttribute("disabled"))})})})}catch{alert("An error occurred, You can't like this post"),document.getElementById(`btnLike${t}`).removeAttribute("disabled")}}}return(l,t)=>(B(),x("button",{onClick:t[0]||(t[0]=A(e=>y(U(k).signedUser.id,a.viewPostId,a.viewPostPosterId),["prevent"])),id:`btnLike${r.viewPostId}`,class:"like-button"},W,8,T))}});const tt=D(X,[["__scopeId","data-v-6bc22f3f"]]),w=r=>(E("data-v-ad1b4381"),r=r(),q(),r),et=["id"],ot={key:0,width:"30",height:"30",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},st=w(()=>s("g",{id:"SVGRepo_bgCarrier","stroke-width":"0"},null,-1)),it=w(()=>s("g",{id:"SVGRepo_tracerCarrier","stroke-linecap":"round","stroke-linejoin":"round"},null,-1)),nt=w(()=>s("g",{id:"SVGRepo_iconCarrier"},[s("path",{d:"M10.5 8.56L12 10.06M12 10.06L13.5 11.56M12 10.06L13.5 8.56M12 10.06L10.5 11.56M8.25 5H15.75C16.4404 5 17 5.58763 17 6.3125V19L12 15.5L7 19V6.3125C7 5.58763 7.55964 5 8.25 5Z",stroke:"#000000","stroke-linecap":"round","stroke-linejoin":"round"})],-1)),rt=[st,it,nt],at={key:1,width:"30",height:"30",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},lt=w(()=>s("g",{id:"SVGRepo_bgCarrier","stroke-width":"0"},null,-1)),dt=w(()=>s("g",{id:"SVGRepo_tracerCarrier","stroke-linecap":"round","stroke-linejoin":"round"},null,-1)),ct=w(()=>s("g",{id:"SVGRepo_iconCarrier"},[s("path",{d:"M10.5 10.5L11.5 11.5L14 9M8.25 5H15.75C16.4404 5 17 5.58763 17 6.3125V19L12 15.5L7 19V6.3125C7 5.58763 7.55964 5 8.25 5Z",stroke:"#000000","stroke-linecap":"round","stroke-linejoin":"round"})],-1)),kt=[lt,dt,ct],pt=w(()=>s("span",null,"0",-1)),ut=M({__name:"useBookmarks",props:{viewPostId:String},setup(r){const a=r,{app:$}=G(),i=Y($),k=I(),b=f(v(i,"posts"),g("postId","==",`${a.viewPostId}`)),y=Q(!1);async function l(e){try{const o=u(i,"users",`${e}`),p=await O(o);if(p.exists()){const L=p.data().bookmarks;k.signedUser.bookmarks=L}}catch(o){console.error("Error getting field from Firebase:",o)}}j(()=>{F(b,e=>{const o=e.docs[0].data();o!=null&&o.length!==0&&(o.postBookmarks.includes(k.signedUser.id)?(y.value=!0,document.querySelectorAll(`#btnBook${a.viewPostId} span`).forEach(p=>{p.textContent=`${o.postBookmarks.length}`}),l(k.signedUser.id)):o.postBookmarks.includes(k.signedUser.id)||(y.value=!1,document.querySelectorAll(`#btnBook${a.viewPostId} span`).forEach(p=>{p.textContent=`${o.postBookmarks.length}`}),l(k.signedUser.id)))})});function t(e,o){if(e===""||e===void 0)confirm("You must be logged in to bookmark a post, will you love to sign up?")&&R.push("/join");else{document.getElementById(`btnLike${o}`).setAttribute("disabled","true");const p=f(v(i,"users"),g("id","==",`${e}`)),L=f(v(i,"posts"),g("postId","==",`${o}`));try{P(p).then(C=>{const n=C.docs[0].data();P(L).then(S=>{const d=S.docs[0].data();n!=null&&n.length!==0&&d!==void 0&&d!==null&&d.length!==0&&(n.bookmarks.some(_=>_===d.postId)?(h(u(i,"users",`${e}`),{bookmarks:n.bookmarks.filter(_=>_!==o)}),h(u(i,"posts",`${o}`),{postBookmarks:d.postBookmarks.filter(_=>_!==e)})):(h(u(i,"users",`${e}`),{bookmarks:[...n.bookmarks,o]}),h(u(i,"posts",`${o}`),{postBookmarks:[...d.postBookmarks,e]})),document.getElementById(`btnLike${o}`).removeAttribute("disabled"))})})}catch{document.getElementById(`btnLike${o}`).removeAttribute("disabled")}}}return(e,o)=>(B(),x("button",{id:`btnBook${r.viewPostId}`,onClick:o[0]||(o[0]=A(p=>t(U(k).signedUser.id,a.viewPostId),["prevent"]))},[y.value?(B(),x("svg",ot,rt)):(B(),x("svg",at,kt)),pt],8,et))}});const mt=D(ut,[["__scopeId","data-v-ad1b4381"]]),H=r=>(E("data-v-1dd1c361"),r=r(),q(),r),ht={class:"analysesDisplay"},_t=H(()=>s("svg",{xmlns:"http://www.w3.org/2000/svg",x:"0px",y:"0px",width:"15",height:"15",viewBox:"0 0 50 50"},[s("path",{"stroke-width":"3",d:"M25 4.0703125C12.368265 4.0703125 2.0703125 12.921644 2.0703125 24C2.0703125 30.432481 5.5907163 36.030749 11.003906 39.6875C10.995106 39.903125 11.010706 40.250912 10.728516 41.294922C10.378462 42.590119 9.6725023 44.413033 8.2382812 46.46875L7.21875 47.929688L9 47.929688C15.17102 47.929688 18.741544 43.907595 19.294922 43.261719C21.134317 43.693171 23.024914 43.929686 25 43.929688C37.631735 43.929688 47.929688 35.078356 47.929688 24C47.929688 12.921644 37.631735 4.0703125 25 4.0703125zM25 5.9296875C36.768265 5.9296875 46.070312 14.078356 46.070312 24C46.070312 33.921644 36.768265 42.070312 25 42.070312C22.959016 42.070312 21.040073 41.87506 19.236328 41.400391L18.654297 41.248047L18.277344 41.714844C18.277344 41.714844 15.390792 44.972581 10.78125 45.757812C11.617979 44.248964 12.233683 42.844161 12.521484 41.779297C12.921431 40.299494 12.929687 39.300781 12.929688 39.300781L12.929688 38.789062L12.5 38.515625C7.2214165 35.156526 3.9296875 29.955741 3.9296875 24C3.9296875 14.078356 13.231735 5.9296875 25 5.9296875z"})],-1)),ft={disabled:""},gt=H(()=>s("svg",{xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",version:"1.1",width:"25",height:"25",viewBox:"0 0 256 256","xml:space":"preserve"},[s("defs"),s("g",{style:{stroke:"none","stroke-width":"0","stroke-dasharray":"none","stroke-linecap":"butt","stroke-linejoin":"miter","stroke-miterlimit":"10",fill:"none","fill-rule":"nonzero",opacity:"1"},transform:"translate(1.4065934065934016 1.4065934065934016) scale(2.81 2.81)"},[s("path",{d:"M 45 66.739 c -11.987 0 -21.74 -9.752 -21.74 -21.739 S 33.013 23.26 45 23.26 S 66.739 33.013 66.739 45 S 56.987 66.739 45 66.739 z M 45 29.26 c -8.679 0 -15.74 7.061 -15.74 15.74 S 36.321 60.739 45 60.739 S 60.739 53.679 60.739 45 S 53.679 29.26 45 29.26 z",style:{stroke:"none","stroke-width":"1","stroke-dasharray":"none","stroke-linecap":"butt","stroke-linejoin":"miter","stroke-miterlimit":"10","fill-rule":"nonzero",opacity:"1"},transform:" matrix(1 0 0 1 0 0) ","stroke-linecap":"round"}),s("path",{d:"M 45 66.763 c -14.477 0 -28.953 -6.054 -43.328 -18.16 C 0.609 47.708 0 46.395 0 45 s 0.609 -2.708 1.672 -3.603 c 28.751 -24.214 57.906 -24.214 86.656 0 l 0 0 C 89.391 42.293 90 43.605 90 45 s -0.609 2.707 -1.672 3.602 C 73.953 60.709 59.477 66.763 45 66.763 z M 6.726 45 c 25.74 21.046 50.809 21.048 76.547 0 C 57.536 23.954 32.467 23.952 6.726 45 z M 84.459 45.984 c 0.001 0.001 0.003 0.002 0.004 0.003 C 84.461 45.986 84.461 45.985 84.459 45.984 z",style:{stroke:"none","stroke-width":"1","stroke-dasharray":"none","stroke-linecap":"butt","stroke-linejoin":"miter","stroke-miterlimit":"10","fill-rule":"nonzero",opacity:"1"},transform:" matrix(1 0 0 1 0 0) ","stroke-linecap":"round"}),s("circle",{cx:"45",cy:"45",r:"7",style:{stroke:"none","stroke-width":"1","stroke-dasharray":"none","stroke-linecap":"butt","stroke-linejoin":"miter","stroke-miterlimit":"10","fill-rule":"nonzero",opacity:"1"},transform:"  matrix(1 0 0 1 0 0) "})])],-1)),vt=M({__name:"useDetailButtons",props:{post:{type:Object,required:!0}},setup(r){const a=r,$=Z(),i=k=>{$.push(`/post/${k}`)};return(k,b)=>(B(),x("div",ht,[V(tt,{viewPostId:a.post.postId,viewPostPosterId:a.post.posterId},null,8,["viewPostId","viewPostPosterId"]),s("button",{onClick:b[0]||(b[0]=A(y=>i(a.post.postId),["prevent"]))},[_t,s("span",null,z(a.post.postComments.total),1)]),s("button",ft,[gt,s("span",null,z(a.post.postViews),1)]),V(mt,{"view-post-id":a.post.postId},null,8,["view-post-id"])]))}});const Lt=D(vt,[["__scopeId","data-v-1dd1c361"]]);export{Lt as u};
