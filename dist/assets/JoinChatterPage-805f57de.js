import{d as A,u as R,r as y,a as D,b as L,c as u,e as T,f as p,g as a,h as $,i as E,j as i,m as V,A as z,q as F,s as G}from"./index-84880169.js";import{u as J,a as M,b as H,c as j,G as q,d as O}from"./useAuth.vue_vue_type_script_lang-1fcab594.js";import{P as W,R as Y,b as K,_ as Q,d as X,m as Z,g as ee}from"./index.esm2017-9b22bd16.js";import{g as te,r as ae,a as oe}from"./index.esm2017-5d7e461f.js";import{_ as ne}from"./useLoadingPage.vue_vue_type_style_index_0_lang-4572f39b.js";import{a as se}from"./axios-4a70c6fc.js";import{u as ie}from"./useUserDetails.vue_vue_type_script_lang-d0217ef7.js";import{_ as ce}from"./_plugin-vue_export-helper-c27b6911.js";const h=l=>(F("data-v-727acabb"),l=l(),G(),l),le={key:1,id:"JoinPage"},re=h(()=>a("button",null,"Home",-1)),de=["title"],ue={id:"themeImgContainer"},he=["src"],me={id:"Authenticate"},ge={key:0,class:"section"},_e=h(()=>a("h2",null,"You are Logged In",-1)),pe=[_e],ve={key:1,class:"section"},fe=z('<svg class="google-icon" viewBox="0 0 533.5 544.3" data-v-727acabb><path fill="#4285F4" d="M533.5 278.2c0-18.3-1.5-36.3-4.4-53.8H272.2v98.7h139.2c-6.1 32.3-24.1 59.6-51 77.9v65h82.7c48.6-44.8 76.3-110.8 76.3-187.8z" data-v-727acabb></path><path fill="#34A853" d="M272.2 544.3c69.3 0 127.4-22.6 169.9-61.6l-82.7-65c-22.9 15.4-52.5 24.4-87.2 24.4-66.8 0-123.4-45.1-143.9-105.6H28.9v65c42.2 83.2 127.1 137.2 227.6 137.2z" data-v-727acabb></path><path fill="#FBBC05" d="M128.3 323.9c-7.6-22.9-7.6-47.6 0-70.6V187h-87.2c-26.4 51.2-26.4 111.4 0 162.6l87.2-65z" data-v-727acabb></path><path fill="#EB4335" d="M272.2 106.7c37.6 0 71.6 12.9 98.3 34l73.7-73.7C399.6 19.7 339.2 0 272.2 0 171.7 0 86.8 54 44.6 135.1l87.6 65c20.5-60.5 76.9-103.4 140-103.4z" data-v-727acabb></path></svg>',1),we=h(()=>a("section",{id:"footer"}," Â© Olaegbe Abdul-Rahmon Pelumi 2023 ",-1)),be=h(()=>a("div",{id:"warningShow"},null,-1)),ye=A({__name:"JoinChatterPage",setup(l){ie();const{auth:v,provider:k,app:f}=J(),w=W(f),o=M(),C=te(f),m=R(),n=y({}),r=y(!0);let b;async function S(e,t){const g=`https://www.googleapis.com/oauth2/v1/userinfo?alt=json&access_token=${e}`;se.post("/access",{accessUrl:g}).then(s=>{n.value=s.data;const B=Y(Q(w,"users"),K("email","==",`${n.value.email}`));X(B).then(_=>{const c=_==null?void 0:_.docs;if(c.length<1&&n.value.email){const d=o.createUser(n.value.email),P=n.value.given_name!==void 0?n.value.given_name:"",U=n.value.family_name!==void 0?n.value.family_name:"";d.fullName=P+" "+U,d.id=t.user.uid;const I=ae(C,"ChatterAppFiles/avatar/unknown/UnkownUser.png");oe(I).then(N=>{d.profilePicture=N}).finally(()=>{Z(ee(w,"users",`${t.user.uid}`),{...d}).then(()=>{r.value=!0,m.push("/additionalData")})})}else c.length>0&&c[0].data().username.trim()!==""?(r.value=!0,m.push("/home")):c.length>0&&c[0].data().username===""&&m.push("/additionalData")})}).catch(()=>{const s=document.getElementById("warningShow");s&&(s.style.display="flex",s.textContent="Something went wrong, check your internet connection and try again.")})}function x(){H(v,O),j(v,k).then(e=>{const t=q.credentialFromResult(e);S(t==null?void 0:t.accessToken,e)}).catch(()=>{const e=document.getElementById("warningShow");e&&(e.style.display="flex",e.textContent="Something went wrong, check your internet connection and try again.")})}return b=setTimeout(()=>{r.value=!1},3e3),D(()=>{clearTimeout(b);const e=document.getElementById("warningShow");e&&(e.style.display="none")}),(e,t)=>{const g=L("RouterLink");return r.value?(u(),T(ne,{key:0,actionName:"Loading..."},null,8,["actionName"])):(u(),p("main",le,[a("header",null,[$(g,{to:"/"},{default:E(()=>[re]),_:1}),a("button",{title:i(o).themeDetails.title,id:"themeBtn",onClick:t[0]||(t[0]=(...s)=>i(o).changeTheme&&i(o).changeTheme(...s))},[a("div",ue,[a("img",{src:i(o).themeDetails.img},null,8,he)])],8,de)]),a("div",me,[i(o).authenticated&&i(o).signedUser.username!==""&&i(o).signedUser.username!==void 0?(u(),p("div",ge,pe)):(u(),p("div",ve,[a("button",{class:"google-button",onClick:t[1]||(t[1]=s=>x())},[fe,V(" Continue with Google ")])]))]),we,be]))}}});const Ne=ce(ye,[["__scopeId","data-v-727acabb"]]);export{Ne as default};
