import{d as $,a as q,r as g,u as H,q as F,o as A,s as I,c as h,f as y,F as E,x as V,k as O,y as z,g as a,w as k,t as M,i as Q,p as j,n as G,_ as J}from"./index-0d83a52f.js";import{u as K,a as W}from"./useAuth.vue_vue_type_script_lang-6fe6b92b.js";import{g as X,r as Y,a as Z}from"./index.esm2017-f1785873.js";import{P as ee,R as te,_ as oe,b as se,d as ne,g as ae,c as re}from"./index.esm2017-3589eea2.js";import{u as le}from"./useUserDetails.vue_vue_type_script_lang-8130a85e.js";import{a as ie}from"./axios-4a70c6fc.js";import{u as ce}from"./useDetailButtons-f28c8ea1.js";import{c as ue}from"./useCalculateTime.vue_vue_type_script_lang-ca052a8e.js";import"./useLikeButton-25f53cfb.js";const de=u=>(j("data-v-ab2f216d"),u=u(),G(),u),me=de(()=>a("h2",null,"Bookmarks",-1)),pe={key:0,class:z({resultsContainer:!0})},fe=["src","alt","onClick"],ge={class:"result-item-other"},he={class:"result-item-header"},ye=["onClick"],ve=["innerHTML","onClick"],_e=$({__name:"BookMarks",setup(u){let d;q(()=>{clearTimeout(d);const t=document.getElementById("warningShow");t.style.display="none"});const i=g(""),C=new DOMParser;le();const{app:S}=K(),D=X(S),b=W(),P=ee(S),v=H(),x=g(!0),m=g([]),p=g();F(()=>{var t;((t=m.value)==null?void 0:t.length)>0&&I(()=>{const s=document.getElementById("warningShow");s&&(s.style.display="none")})}),A(()=>{clearTimeout(d),I(()=>{const t=document.getElementById("warningShow");t&&(t.style.display="flex",t.textContent="Loading ...")}),U(b.signedUser.bookmarks)});function L(t){v.push(`/post/${t}`)}function T(t){if(t===b.signedUser.id)return v.push("/userProfile");v.push(`/chatterUser/${t}`)}async function N(t){i.value="";try{const s=Y(D,t.postContain),o=await Z(s).catch(e=>{console.log(e)});await ie.post("/postContent",{contentUrl:o}).then(e=>{const n=C.parseFromString(e.data,"text/html");i.value=n.body.innerHTML}).catch(e=>{console.log(e)})}catch{const o=document.getElementById("ErrorShow");o.style.display="flex",o.textContent="Something went wrong, check your internet connection",d=setTimeout(()=>{o.style.display="none"},3e3)}}async function R(t){p.value=null;try{const s=ae(P,"users",t),o=await re(s);if(o.data()!==void 0){const{fullName:e,profilePicture:n,username:r,blogName:_}=o.data(),l={profilePicture:n,posterID:t,fullName:e,username:r,blogName:_};p.value={id:t,img:l.profilePicture,fullName:l.fullName,username:l.username,blogname:l.blogName}}}catch{}}async function U(t){try{const s=t.map(async n=>{const r=te(oe(P,"posts"),se("postId","==",n)),_=await ne(r);return Promise.all(_.docs.map(async l=>{var B;const c=l.data();await N(c);const f=C.parseFromString(i.value,"text/html");return f.body.querySelectorAll("img").forEach(w=>{w.remove()}),f.body.querySelectorAll("video").forEach(w=>{w.remove()}),(B=f.body.querySelector("h1"))==null||B.remove(),i.value=f.body.innerHTML,c.postContain=i.value,await R(c.posterId),c.posterDetails=p.value,p.value=null,x.value=!1,c}))}),e=(await Promise.all(s)).flat();m.value=e}catch(s){console.log(s);const o=document.getElementById("ErrorShow");o.style.display="flex",o.textContent="Something went wrong, check your internet connection",d=setTimeout(()=>{o.style.display="none"},3e3)}}return(t,s)=>{var o;return h(),y(E,null,[me,((o=m.value)==null?void 0:o.length)>0&&x.value===!1?(h(),y("div",pe,[(h(!0),y(E,null,V(m.value,(e,n)=>(h(),y("div",{key:n,class:"result-item"},[a("img",{src:e==null?void 0:e.posterDetails.img,alt:(e==null?void 0:e.posterDetails.username)+"profile picture",class:"result-item-image",onClick:k(r=>T(e.posterId),["prevent"])},null,8,fe),a("div",ge,[a("div",he,[a("span",{onClick:k(r=>T(e.posterId),["prevent"])},M(e==null?void 0:e.posterDetails.blogname),9,ye),a("span",null,M(ue(e.postTime.seconds)),1)]),a("div",{innerHTML:e.postContain,id:"divContent",onClick:k(r=>L(e.postId),["prevent"])},null,8,ve),Q(ce,{post:e},null,8,["post"])])]))),128))])):O("",!0)],64)}}});const Ie=J(_e,[["__scopeId","data-v-ab2f216d"]]);export{Ie as default};
