import{d as j,u as z,r as k,o as G,s as Q,a as J,b as $,c as u,e as K,f as _,g as e,w as C,h as s,t as a,i as h,j as f,y as P,l as c,k as S,F as W,x as X,p as Y,n as Z,_ as ee}from"./index-0d83a52f.js";import{a as te,u as se}from"./useAuth.vue_vue_type_script_lang-6fe6b92b.js";import{_ as oe}from"./useLoadingPage.vue_vue_type_style_index_0_lang-d974f102.js";import{g as ne,r as ie,a as ae}from"./index.esm2017-f1785873.js";import{P as le,R as re,_ as ce,b as de,d as ue,g as pe,c as _e}from"./index.esm2017-3589eea2.js";import{u as me}from"./useUserDetails.vue_vue_type_script_lang-8130a85e.js";import{S as he}from"./useSignOut.vue_vue_type_script_lang-21763193.js";import{c as ge}from"./useCalculateTime.vue_vue_type_script_lang-ca052a8e.js";import{u as fe}from"./useDetailButtons-f28c8ea1.js";import{a as ve}from"./axios-4a70c6fc.js";import{g as ye}from"./useUserViewProfile.vue_vue_type_script_lang-37094748.js";import"./useLikeButton-25f53cfb.js";const r=U=>(Y("data-v-11110da2"),U=U(),Z(),U),Ue={key:1},we=["onClick"],be=["title"],ke={id:"themeImgContainer"},Ce=["src"],Pe={class:"body"},Se={class:"imageCon"},De={class:"imgCon"},Ne=["src","alt"],Ie={class:"sectionFoImage"},Te={class:"follow"},Le=r(()=>e("p",null,"||",-1)),Be={class:"btns"},Ee=r(()=>e("button",null,"Edit Profile",-1)),xe={class:"readerSec"},Re={class:"btnSection"},$e=r(()=>e("span",null,"Full Name:",-1)),Fe=r(()=>e("span",null,"User Name:",-1)),Me=r(()=>e("span",null,"Blog Name:",-1)),He={key:0},qe=r(()=>e("span",null,"Biography:",-1)),Ve={key:1},Ae=r(()=>e("span",null,"Email:",-1)),Oe=r(()=>e("span",null,"Location:",-1)),je=r(()=>e("span",null,"Birthday:",-1)),ze=r(()=>e("span",null,"Gender:",-1)),Ge={key:2},Qe=r(()=>e("span",null,"Interests:",-1)),Je={key:0,class:"loading"},Ke={key:1},We={class:"type"},Xe={class:"result-item"},Ye=["src","alt","onClick"],Ze={class:"result-item-other"},et={class:"result-item-header"},tt=["onClick"],st=["innerHTML","onClick"],ot={id:"navigators"},nt=r(()=>e("button",null,"Home",-1)),it=r(()=>e("button",null,"Search",-1)),at=r(()=>e("button",{id:"notification-button"},[c("Notification"),e("span",{class:"dot"})],-1)),lt=j({__name:"UserProfile",setup(U){const m=z(),N=k(!0),t=te();me(),G(()=>{Q(()=>{const o=document.getElementById("warningShow");o.style.display="none"}),ye(t.userId).then(()=>{N.value=!1})});const w=k(),{app:I}=se(),F=ne(I),T=le(I),L=new DOMParser,v=k(""),B=k(!0);async function M(o){v.value="";const l=ie(F,o.postContain),p=await ae(l).catch(i=>{console.log(i)});await ve.post("/postContent",{contentUrl:p}).then(i=>{const n=L.parseFromString(i.data,"text/html");v.value=n.body.innerHTML}).catch(i=>{console.log(i)})}async function H(o){w.value=null;try{const l=pe(T,"users",o),p=await _e(l);if(p.data()!==void 0){const{fullName:i,profilePicture:n,username:y,blogName:g}=p.data(),d={profilePicture:n,posterID:o,fullName:i,username:y,blogName:g};w.value={id:o,img:d.profilePicture,fullName:d.fullName,username:d.username,blogname:d.blogName}}}catch{}}async function q(o){if(o.length>0)try{const l=o.map(async i=>{const n=re(ce(T,"posts"),de("postId","==",i.details.postid)),y=await ue(n);return Promise.all(y.docs.map(async g=>{var R;const d=g.data();await M(d);const b=L.parseFromString(v.value,"text/html");return b.body.querySelectorAll("img").forEach(D=>{D.remove()}),b.body.querySelectorAll("video").forEach(D=>{D.remove()}),(R=b.body.querySelector("h1"))==null||R.remove(),v.value=b.body.innerHTML,d.postContain=v.value,await H(d.posterId),d.posterDetails=w.value,w.value=null,{type:i.type,postDetails:d}}))}),p=await Promise.all(l);t.viwedProfile.interactions=p.flat(),B.value=!1}catch{}else return}function V(){m.go(-1)}function E(o){t.section=o,o==="interaction"&&t.userId!==""&&t.userId!==void 0&&q(t.viwedProfile.interactions)}function A(o){m.push(`/post/${o}`)}function x(o){if(o===t.signedUser.id)return m.push("/userProfile");m.push(`/chatterUser/${o}`)}let O=setTimeout(()=>{t.signedUser.id===void 0&&t.authenticated===!1?m.push("/home"):t.authenticated===!0&&(t.signedUser.id===void 0&&t.signedUser.username===void 0?m.push({name:"NetworkError",query:{redirect:`${m.currentRoute.value.path}`}}):t.signedUser.id!==void 0&&t.signedUser.username===""&&(console.log("User registration not finished... Logging out user....."),he(),t.authenticated=!1,m.push("/login")))},5e3);return J(()=>{clearTimeout(O);const o=document.getElementById("warningShow");o.style.display="none"}),(o,l)=>{const p=$("P"),i=$("RouterLink");return N.value?(u(),K(oe,{key:0,"action-name":"Loading profile..."})):(u(),_("main",Ue,[e("header",null,[e("button",{onClick:C(V,["prevent"])},"Back",8,we),e("button",{title:s(t).themeDetails.title,id:"themeBtn",onClick:l[0]||(l[0]=(...n)=>s(t).changeTheme&&s(t).changeTheme(...n))},[e("div",ke,[e("img",{src:s(t).themeDetails.img},null,8,Ce)])],8,be)]),e("div",Pe,[e("div",Se,[e("div",De,[e("img",{src:s(t).viwedProfile.profilePicture,height:"40",alt:s(t).signedUser.fullName+"profile pic"},null,8,Ne)])]),e("section",Ie,[e("h3",null,a(s(t).signedUser.fullName),1),e("div",Te,[h(p,null,{default:f(()=>[c(a(s(t).signedUser.followers.total)+" Followers",1)]),_:1}),Le,h(p,null,{default:f(()=>[c(a(s(t).signedUser.following.total)+" Following",1)]),_:1})])]),e("div",Be,[h(i,{to:{name:"EditProfile"}},{default:f(()=>[Ee]),_:1})]),e("div",xe,[e("div",Re,[e("button",{onClick:l[1]||(l[1]=n=>E("personal")),class:P({active:s(t).section==="personal"})},"Personal",2),e("button",{onClick:l[2]||(l[2]=n=>E("interaction")),class:P({active:s(t).section==="interaction"})},"Interactions",2)]),e("div",{class:P({show:s(t).section==="personal",none:s(t).section!=="personal",personal:!0})},[e("p",null,[$e,c(" "+a(s(t).signedUser.fullName),1)]),e("p",null,[Fe,c(" "+a(s(t).signedUser.username),1)]),e("p",null,[Me,c(" "+a(s(t).signedUser.blogName),1)]),s(t).signedUser.bio.length>0?(u(),_("p",He,[qe,c(" "+a(s(t).signedUser.bio),1)])):S("",!0),s(t).signedUser.settings.privacySettings.showEmail?(u(),_("p",Ve,[Ae,c(" "+a(s(t).signedUser.email),1)])):S("",!0),e("p",null,[Oe,c(" "+a(s(t).signedUser.location),1)]),e("p",null,[je,c(" "+a(s(t).signedUser.dateOfBirth),1)]),e("p",null,[ze,c(" "+a(s(t).signedUser.gender),1)]),s(t).signedUser.interests.length>0?(u(),_("p",Ge,[Qe,c(" "+a(s(t).signedUser.interests.join(",")),1)])):S("",!0)],2),s(t).section==="interaction"?(u(),_("div",{key:0,class:P({show:s(t).section==="interaction",none:s(t).section!=="interaction",interaction:!0})},[B.value?(u(),_("p",Je,"Loading...")):(u(),_("div",Ke,[(u(!0),_(W,null,X(s(t).viwedProfile.interactions,(n,y)=>(u(),_("div",{key:y},[e("div",We,a(n.type),1),e("div",Xe,[e("img",{src:n.postDetails.posterDetails.img,alt:n.postDetails.posterDetails.username+"profile picture",class:"result-item-image",onClick:C(g=>x(n.postDetails.posterId),["prevent"])},null,8,Ye),e("div",Ze,[e("div",et,[e("span",{onClick:C(g=>x(n.postDetails.posterId),["prevent"])},a(s(t).signedUser.blogName),9,tt),e("span",null,a(ge(n.postDetails.postTime.seconds)),1)]),e("div",{innerHTML:n.postDetails.postContain,id:"divContent",onClick:C(g=>A(n.postDetails.postId),["prevent"])},null,8,st),h(fe,{post:n.postDetails},null,8,["post"])])])]))),128))]))],2)):S("",!0)]),e("section",ot,[h(i,{to:"/home"},{default:f(()=>[nt]),_:1}),h(i,{to:"/search"},{default:f(()=>[it]),_:1}),h(i,{to:"/notification"},{default:f(()=>[at]),_:1})])])]))}}});const wt=ee(lt,[["__scopeId","data-v-11110da2"]]);export{wt as default};
