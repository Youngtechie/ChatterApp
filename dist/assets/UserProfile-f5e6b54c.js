import{d as z,u as A,r as y,o as O,x as j,s as G,a as Q,b as J,c as d,e as K,f as u,g as e,w as U,j as t,n as W,t as i,k,h as w,i as D,z as b,l as m,F as X,y as Y,p as Z,q as ee,_ as se}from"./index-9d180844.js";import{a as te,u as oe}from"./useAuth.vue_vue_type_script_lang-345c5324.js";import{_ as ne}from"./useLoadingPage.vue_vue_type_style_index_0_lang-aca7865e.js";import{P as ie,R as ae,_ as le,b as re,d as ce,g as de,c as ue}from"./index.esm2017-b1be84ac.js";import{u as pe}from"./useUserDetails.vue_vue_type_script_lang-331a5968.js";import{S as me}from"./useSignOut.vue_vue_type_script_lang-93073ada.js";import{c as _e}from"./useCalculateTime.vue_vue_type_script_lang-ca052a8e.js";import{u as he}from"./useDetailButtons-3c685b48.js";import{a as ge}from"./axios-4a70c6fc.js";const r=f=>(Z("data-v-6c1fac1e"),f=f(),ee(),f),fe={key:1},ve=["onClick"],ye=["title"],Ue={id:"themeImgContainer"},ke=["src"],we={class:"body"},be={class:"imageCon"},Ce={class:"sectionFoImage"},Pe={key:0},Se={class:"follow"},De=r(()=>e("p",null,"||",-1)),Ie={class:"btns"},Ne=r(()=>e("button",null,"Edit Profile",-1)),Te={class:"readerSec"},Le={class:"btnSection"},Ee={class:"personalDetails"},Be=r(()=>e("span",null,"Full Name:",-1)),xe=r(()=>e("span",null,"User Name:",-1)),$e=r(()=>e("span",null,"Blog Name:",-1)),Re={key:0},Fe=r(()=>e("span",null,"Email:",-1)),Me=r(()=>e("span",null,"Location:",-1)),qe=r(()=>e("span",null,"Birthday:",-1)),He=r(()=>e("span",null,"Gender:",-1)),Ve={key:1},ze=r(()=>e("span",null,"Interests:",-1)),Ae={key:0,id:"warningShow"},Oe={key:1},je={class:"type"},Ge={class:"result-item"},Qe=["src","alt","onClick"],Je={class:"result-item-other"},Ke={class:"result-item-header"},We=["onClick"],Xe=["innerHTML","onClick"],Ye={id:"navigators"},Ze=r(()=>e("button",null,"Home",-1)),es=r(()=>e("button",null,"Search",-1)),ss=z({__name:"UserProfile",setup(f){const p=A(),I=y(!0),s=te();O(()=>{pe(),j(()=>{const o=document.getElementById("warningShow");o.style.display="none"}),s.section="personal"}),G(()=>{s.signedUser.id!==void 0&&(I.value=!1)});const C=y(),{app:$}=oe(),N=ie($),T=new DOMParser,h=y(""),L=y(!0);async function R(o){h.value="";const a=o.postContain;await ge.post("/postContent",{contentUrl:a}).then(l=>{const n=T.parseFromString(l.data,"text/html");h.value=n.body.innerHTML}).catch(l=>{console.log(l)})}async function F(o){C.value=null;try{const a=de(N,"users",o),l=await ue(a);if(l.data()!==void 0){const{fullName:n,profilePicture:g,username:_,blogName:P}=l.data(),c={profilePicture:g,posterID:o,fullName:n,username:_,blogName:P};C.value={id:o,img:c.profilePicture,fullName:c.fullName,username:c.username,blogname:c.blogName}}}catch{}}async function M(o){if(o.length>0)try{const a=o.map(async n=>{const g=ae(le(N,"posts"),re("postId","==",n.details.postid)),_=await ce(g);return Promise.all(_.docs.map(async P=>{var x;const c=P.data();await R(c);const v=T.parseFromString(h.value,"text/html");return v.body.querySelectorAll("img").forEach(S=>{S.remove()}),v.body.querySelectorAll("video").forEach(S=>{S.remove()}),(x=v.body.querySelector("h1"))==null||x.remove(),h.value=v.body.innerHTML,c.postContain=h.value,await F(c.posterId).then(()=>{c.posterDetails=C.value}),{type:n.type,postDetails:c}}))}),l=await Promise.all(a);s.signedUser.interactions=l.flat()}catch{}else return}function q(){p.go(-1)}function E(o){s.section=o,o==="interaction"&&s.userId!==""&&s.userId!==void 0&&M(s.signedUser.interactions).finally(()=>{console.log(s.signedUser.interactions),L.value=!1})}function H(o){p.push(`/post/${o}`)}function B(o){if(o===s.signedUser.id)return p.push("/userProfile");p.push(`/chatterUser/${o}`)}let V=setTimeout(()=>{s.signedUser.id===void 0&&s.authenticated===!1?p.push("/home"):s.authenticated===!0&&(s.signedUser.id===void 0&&s.signedUser.username===void 0?p.push({name:"NetworkError",query:{redirect:`${p.currentRoute.value.path}`}}):s.signedUser.id!==void 0&&s.signedUser.username===""&&(console.log("User registration not finished... Logging out user....."),me(),s.authenticated=!1,p.push("/login")))},5e3);return Q(()=>{clearTimeout(V);const o=document.getElementById("warningShow");o.style.display="none"}),(o,a)=>{const l=J("RouterLink");return I.value?(d(),K(ne,{key:0,"action-name":"Loading profile..."})):(d(),u("main",fe,[e("header",null,[e("button",{onClick:U(q,["prevent"])},"Back",8,ve),e("button",{title:t(s).themeDetails.title,id:"themeBtn",onClick:a[0]||(a[0]=(...n)=>t(s).changeTheme&&t(s).changeTheme(...n))},[e("div",Ue,[e("img",{src:t(s).themeDetails.img},null,8,ke)])],8,ye)]),e("div",we,[e("div",be,[e("div",{class:"imgCon",style:W({backgroundImage:`url(${t(s).signedUser.profilePicture})`})},null,4)]),e("section",Ce,[e("h3",null,i(t(s).signedUser.fullName),1),t(s).signedUser.bio.length>0?(d(),u("p",Pe,i(t(s).signedUser.bio),1)):k("",!0),e("div",Se,[e("p",null,i(t(s).signedUser.followers.total)+" Followers",1),De,e("p",null,i(t(s).signedUser.following.total)+" Following",1)])]),e("div",Ie,[w(l,{to:{name:"EditProfile"}},{default:D(()=>[Ne]),_:1})]),e("div",Te,[e("div",Le,[e("button",{onClick:a[1]||(a[1]=n=>E("personal")),class:b({active:t(s).section==="personal"})},"Personal",2),e("button",{onClick:a[2]||(a[2]=n=>E("interaction")),class:b({active:t(s).section==="interaction"})},"Interactions",2)]),e("div",{class:b({show:t(s).section==="personal",none:t(s).section!=="personal",personal:!0})},[e("div",Ee,[e("p",null,[Be,m(" "+i(t(s).signedUser.fullName),1)]),e("p",null,[xe,m(" "+i(t(s).signedUser.username),1)]),e("p",null,[$e,m(" "+i(t(s).signedUser.blogName),1)]),t(s).signedUser.settings.privacySettings.showEmail?(d(),u("p",Re,[Fe,m(" "+i(t(s).signedUser.email),1)])):k("",!0),e("p",null,[Me,m(" "+i(t(s).signedUser.location),1)]),e("p",null,[qe,m(" "+i(t(s).signedUser.dateOfBirth),1)]),e("p",null,[He,m(" "+i(t(s).signedUser.gender),1)]),t(s).signedUser.interests.length>0?(d(),u("p",Ve,[ze,m(" "+i(t(s).signedUser.interests.join(",")),1)])):k("",!0)])],2),t(s).section==="interaction"?(d(),u("div",{key:0,class:b({show:t(s).section==="interaction",none:t(s).section!=="interaction",interaction:!0})},[L.value?(d(),u("div",Ae,"Loading ...")):(d(),u("div",Oe,[(d(!0),u(X,null,Y(t(s).signedUser.interactions,(n,g)=>(d(),u("div",{key:g,class:"resultContainer"},[e("div",je,i(n.type),1),e("div",Ge,[e("img",{src:n.postDetails.posterDetails.img,alt:n.postDetails.posterDetails.username+"profile picture",class:"result-item-image",onClick:U(_=>B(n.postDetails.posterId),["prevent"])},null,8,Qe),e("div",Je,[e("div",Ke,[e("span",{onClick:U(_=>B(n.postDetails.posterId),["prevent"])},i(t(s).signedUser.blogName),9,We),e("span",null,i(_e(n.postDetails.postTime.seconds)),1)]),e("div",{innerHTML:n.postDetails.postContain,id:"divContent",onClick:U(_=>H(n.postDetails.postId),["prevent"])},null,8,Xe),w(he,{post:n.postDetails},null,8,["post"])])])]))),128))]))],2)):k("",!0)]),e("section",Ye,[w(l,{to:"/home"},{default:D(()=>[Ze]),_:1}),w(l,{to:"/search"},{default:D(()=>[es]),_:1})])])]))}}});const ps=se(ss,[["__scopeId","data-v-6c1fac1e"]]);export{ps as default};
