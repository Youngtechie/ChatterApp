import{d as I,u as A,r as k,a as N,b as R,c as h,e as D,f as g,g as a,i as L,j as T,h as s,l as $,z,p as E,n as V,_ as F}from"./index-f1eab0dd.js";import{u as G,a as J,b as M,c as H,G as j,d as O}from"./useAuth.vue_vue_type_script_lang-298818ca.js";import{P as W,R as q,_ as Y,b as K,d as Q,m as X,g as Z}from"./index.esm2017-96b642a7.js";import{g as ee,r as te,a as ae}from"./index.esm2017-9ddf60ae.js";import{_ as oe}from"./useLoadingPage.vue_vue_type_style_index_0_lang-a1fcb670.js";import{a as se}from"./axios-4a70c6fc.js";import{u as ne}from"./useUserDetails.vue_vue_type_script_lang-3dc9a373.js";const p=l=>(E("data-v-5c5057af"),l=l(),V(),l),ie={key:1,id:"JoinPage"},ce=p(()=>a("button",null,"Home",-1)),re=["title"],le={id:"themeImgContainer"},de=["src"],ue={id:"Authenticate"},he={key:0,class:"section"},me=p(()=>a("h2",null,"You are Logged In",-1)),_e=[me],ge={key:1,class:"section"},pe=z('<svg class="google-icon" viewBox="0 0 533.5 544.3" data-v-5c5057af><path fill="#4285F4" d="M533.5 278.2c0-18.3-1.5-36.3-4.4-53.8H272.2v98.7h139.2c-6.1 32.3-24.1 59.6-51 77.9v65h82.7c48.6-44.8 76.3-110.8 76.3-187.8z" data-v-5c5057af></path><path fill="#34A853" d="M272.2 544.3c69.3 0 127.4-22.6 169.9-61.6l-82.7-65c-22.9 15.4-52.5 24.4-87.2 24.4-66.8 0-123.4-45.1-143.9-105.6H28.9v65c42.2 83.2 127.1 137.2 227.6 137.2z" data-v-5c5057af></path><path fill="#FBBC05" d="M128.3 323.9c-7.6-22.9-7.6-47.6 0-70.6V187h-87.2c-26.4 51.2-26.4 111.4 0 162.6l87.2-65z" data-v-5c5057af></path><path fill="#EB4335" d="M272.2 106.7c37.6 0 71.6 12.9 98.3 34l73.7-73.7C399.6 19.7 339.2 0 272.2 0 171.7 0 86.8 54 44.6 135.1l87.6 65c20.5-60.5 76.9-103.4 140-103.4z" data-v-5c5057af></path></svg>',1),fe=p(()=>a("section",{id:"footer"}," Â© Olaegbe Abdul-Rahmon Pelumi 2023 ",-1)),ve=I({__name:"JoinChatterPage",setup(l){ne();const{auth:f,provider:C,app:v}=G(),w=W(v),o=J(),b=ee(v),m=A(),n=k({}),d=k(!0);let y;async function P(t,e){try{const c=`https://www.googleapis.com/oauth2/v1/userinfo?alt=json&access_token=${t}`;se.post("/access",{accessUrl:c}).then(i=>{n.value=i.data;const U=q(Y(w,"users"),K("email","==",`${n.value.email}`));Q(U).then(_=>{const r=_==null?void 0:_.docs;if(r.length<1&&n.value.email){const u=o.createUser(n.value.email);u.fullName=n.value.given_name+" "+n.value.family_name,u.id=e.user.uid;const x=te(b,"ChatterAppFiles/avatar/unknown/UnkownUser.png");ae(x).then(S=>{u.profilePicture=S}).finally(()=>{X(Z(w,"users",`${e.user.uid}`),{...u}).then(()=>{d.value=!0,m.push("/additionalData")})})}else r.length>0&&r[0].data().username.trim()!==""?(d.value=!0,m.push("/home")):r.length>0&&r[0].data().username===""&&m.push("/additionalData")})}).catch(i=>{console.log(i)})}catch(c){console.log(c)}}function B(){M(f,O),H(f,C).then(t=>{const e=j.credentialFromResult(t);P(e==null?void 0:e.accessToken,t)}).catch(()=>{const t=document.getElementById("ErrorShow");t.style.display="flex",t.textContent="Something went wrong, check your internet connection and try again."})}return y=setTimeout(()=>{d.value=!1},3e3),N(()=>{clearTimeout(y);const t=document.getElementById("warningShow");t.style.display="none"}),(t,e)=>{const c=R("RouterLink");return d.value?(h(),D(oe,{key:0,actionName:"Loading..."},null,8,["actionName"])):(h(),g("main",ie,[a("header",null,[L(c,{to:"/"},{default:T(()=>[ce]),_:1}),a("button",{title:s(o).themeDetails.title,id:"themeBtn",onClick:e[0]||(e[0]=(...i)=>s(o).changeTheme&&s(o).changeTheme(...i))},[a("div",le,[a("img",{src:s(o).themeDetails.img},null,8,de)])],8,re)]),a("div",ue,[s(o).authenticated&&s(o).signedUser.username!==""&&s(o).signedUser.username!==void 0?(h(),g("div",he,_e)):(h(),g("div",ge,[a("button",{class:"google-button",onClick:e[1]||(e[1]=i=>B())},[pe,$(" Continue with Google ")])]))]),fe]))}}});const Ue=F(ve,[["__scopeId","data-v-5c5057af"]]);export{Ue as default};
