import{d as H,r as m,u as U,o as z,x as b,s as A,a as V,c as p,f as h,F as Q,y as O,k as E,w as _,z as j,g as l,n as G,t as T,h as J,p as K,q as W,_ as X}from"./index-6f23e352.js";import{u as Y,a as Z}from"./useAuth.vue_vue_type_script_lang-d76c59a2.js";import{P as ee,R as I,k as M,x as q,_ as N,d as te,g as oe,c as ne,F as se}from"./index.esm2017-a297fada.js";import{u as ae}from"./useUserDetails.vue_vue_type_script_lang-a91e426b.js";import{a as re}from"./axios-4a70c6fc.js";import{c as le}from"./useCalculateTime.vue_vue_type_script_lang-ca052a8e.js";import{u as ie}from"./useDetailButtons-3d6ae16e.js";const B=v=>(K("data-v-a955a946"),v=v(),W(),v),ce={class:"exploreSection"},ue=B(()=>l("h2",null,"Exploring Posts",-1)),de={key:0,class:j({resultsContainer:!0})},me=["onClick"],pe={class:"result-item-other"},he={class:"result-item-header"},ve=["onClick"],ge=["innerHTML","onClick"],_e=["onClick"],fe=B(()=>l("div",{id:"warningShow"},null,-1)),ye=H({__name:"ExplorePage",setup(v){ae();const c=m([]),u=m(""),S=new DOMParser,f=U(),{app:D}=Y(),y=ee(D),x=Z();x.sidebar=!1;const d=m(null),g=m(),C=m(!0);z(()=>{b(()=>{const e=document.getElementById("warningShow");e&&(e.style.display="flex",e.textContent="Loading ...")}),d.value=I(N(y,"posts"),q("postTime","desc"),M(15)),k(d.value)});async function L(e){u.value="";try{const o=e.postContain;await re.post("/postContent",{contentUrl:o}).then(n=>{const r=S.parseFromString(n.data,"text/html");u.value=r.body.innerHTML}).catch(n=>{console.log(n)})}catch{const n=document.querySelector("#ErrorShow span");document.querySelector("#ErrorShow").style.display="flex",n.textContent="Something went wrong, check your internet connection and reload page"}}async function F(e){g.value=null;try{const o=oe(y,"users",e),n=await ne(o);if(n.data()!==void 0){const{fullName:r,profilePicture:t,username:s,blogName:a}=n.data(),i={profilePicture:t,posterID:e,fullName:r,username:s,blogName:a};g.value={id:e,img:i.profilePicture,fullName:i.fullName,username:i.username,blogname:i.blogName}}}catch{}}async function k(e){const n=(await te(e)).docs.map(async t=>{var i;const s=t.data();await L(s);const a=S.parseFromString(u.value,"text/html");return a.body.querySelectorAll("img").forEach(w=>{w.remove()}),a.body.querySelectorAll("video").forEach(w=>{w.remove()}),(i=a.body.querySelector("h1"))==null||i.remove(),u.value=a.body.innerHTML,s.postContain=u.value,await F(s.posterId),s.posterDetails=g.value,s}),r=await Promise.all(n);c.value=r,g.value=null,C.value=!1}function R(){const e=d.value.docs[d.value.docs.length-1],o=I(N(y,"cities"),q("postTime","desc"),se(e),M(15));k(o).then(()=>{d.value=o})}function $(e){f.push(`/post/${e}`)}function P(e){if(e===x.signedUser.id)return f.push("/userProfile");f.push(`/chatterUser/${e}`)}return A(()=>{var e;((e=c.value)==null?void 0:e.length)>0&&b(()=>{const o=document.getElementById("warningShow");o&&(o.style.display="none")})}),V(()=>{const e=document.getElementById("warningShow");e.style.display="none"}),(e,o)=>{var n,r;return p(),h("main",ce,[ue,((n=c.value)==null?void 0:n.length)>0&&C.value===!1?(p(),h("div",de,[(p(!0),h(Q,null,O(c.value,(t,s)=>(p(),h("div",{key:s,class:"result-item"},[l("div",{class:"imgCon",onClick:_(a=>P(t.posterId),["prevent"]),style:G({backgroundImage:`url(${t==null?void 0:t.posterDetails.img})`})},null,12,me),l("div",pe,[l("div",he,[l("span",{onClick:_(a=>P(t.posterId),["prevent"])},T(t==null?void 0:t.posterDetails.blogname),9,ve),l("span",null,T(le(t.postTime.seconds)),1)]),l("div",{innerHTML:t.postContain,id:"divContent",onClick:_(a=>$(t.postId),["prevent"])},null,8,ge),J(ie,{post:t},null,8,["post"])])]))),128))])):E("",!0),((r=c.value)==null?void 0:r.length)===15?(p(),h("button",{key:1,onClick:_(R,["prevent"])},"See More ....",8,_e)):E("",!0),fe])}}});const Ee=X(ye,[["__scopeId","data-v-a955a946"]]);export{Ee as default};
