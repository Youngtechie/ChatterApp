import{d as I,u as R,r as k,a as D,b as L,c as h,e as T,f as g,g as a,i as $,j as V,h as n,l as z,A as E,p as F,q as G,_ as J}from"./index-3c7daa31.js";import{u as M,P as q,a as H,f as j,h as O,G as W,R as Y,_ as K,c as Q,d as X,m as Z,g as ee,i as te}from"./useAuth.vue_vue_type_script_lang-0a2c6dcb.js";import{g as ae,r as se,a as oe}from"./index.esm2017-3ce07352.js";import{_ as ne}from"./useLoadingPage.vue_vue_type_style_index_0_lang-1a9153d1.js";import{a as ie}from"./axios-4a70c6fc.js";import{u as ce}from"./useUserDetails.vue_vue_type_script_lang-f8979881.js";const p=r=>(F("data-v-d27720ee"),r=r(),G(),r),le={key:1,id:"JoinPage"},re=p(()=>a("button",null,"Home",-1)),de=["title"],ue={id:"themeImgContainer"},he=["src"],me={id:"Authenticate"},_e={key:0,class:"section"},ge=p(()=>a("h2",null,"You are Logged In",-1)),pe=[ge],ve={key:1,class:"section"},fe=E('<svg class="google-icon" viewBox="0 0 533.5 544.3" data-v-d27720ee><path fill="#4285F4" d="M533.5 278.2c0-18.3-1.5-36.3-4.4-53.8H272.2v98.7h139.2c-6.1 32.3-24.1 59.6-51 77.9v65h82.7c48.6-44.8 76.3-110.8 76.3-187.8z" data-v-d27720ee></path><path fill="#34A853" d="M272.2 544.3c69.3 0 127.4-22.6 169.9-61.6l-82.7-65c-22.9 15.4-52.5 24.4-87.2 24.4-66.8 0-123.4-45.1-143.9-105.6H28.9v65c42.2 83.2 127.1 137.2 227.6 137.2z" data-v-d27720ee></path><path fill="#FBBC05" d="M128.3 323.9c-7.6-22.9-7.6-47.6 0-70.6V187h-87.2c-26.4 51.2-26.4 111.4 0 162.6l87.2-65z" data-v-d27720ee></path><path fill="#EB4335" d="M272.2 106.7c37.6 0 71.6 12.9 98.3 34l73.7-73.7C399.6 19.7 339.2 0 272.2 0 171.7 0 86.8 54 44.6 135.1l87.6 65c20.5-60.5 76.9-103.4 140-103.4z" data-v-d27720ee></path></svg>',1),we=p(()=>a("section",{id:"footer"}," Â© Olaegbe Abdul-Rahmon Pelumi 2023 ",-1)),ye=I({__name:"JoinChatterPage",setup(r){ce();const{auth:v,provider:C,app:f}=M(),w=q(f),s=H(),P=ae(f),m=R(),o=k({}),d=k(!0);let y;async function S(t,e){try{const c=`https://www.googleapis.com/oauth2/v1/userinfo?alt=json&access_token=${t}`;ie.post("/access",{accessUrl:c}).then(i=>{o.value=i.data;const b=Y(K(w,"users"),Q("email","==",`${o.value.email}`));X(b).then(_=>{const l=_==null?void 0:_.docs;if(l.length<1&&o.value.email){const u=s.createUser(o.value.email),x=o.value.given_name!==void 0?o.value.given_name:"",B=o.value.family_name!==void 0?o.value.family_name:"";u.fullName=x+" "+B,u.id=e.user.uid;const N=se(P,"ChatterAppFiles/avatar/unknown/UnkownUser.png");oe(N).then(A=>{u.profilePicture=A}).finally(()=>{Z(ee(w,"users",`${e.user.uid}`),{...u}).then(()=>{d.value=!0,m.push("/additionalData")})})}else l.length>0&&l[0].data().username.trim()!==""?(d.value=!0,m.push("/home")):l.length>0&&l[0].data().username===""&&m.push("/additionalData")})}).catch(i=>{console.log(i)})}catch(c){console.log(c)}}function U(){j(v,te),O(v,C).then(t=>{const e=W.credentialFromResult(t);S(e==null?void 0:e.accessToken,t)}).catch(()=>{const t=document.querySelector("#ErrorShow span");t.style.display="flex",t.textContent="Something went wrong, check your internet connection and try again."})}return y=setTimeout(()=>{d.value=!1},3e3),D(()=>{clearTimeout(y);const t=document.getElementById("warningShow");t.style.display="none"}),(t,e)=>{const c=L("RouterLink");return d.value?(h(),T(ne,{key:0,actionName:"Loading..."},null,8,["actionName"])):(h(),g("main",le,[a("header",null,[$(c,{to:"/"},{default:V(()=>[re]),_:1}),a("button",{title:n(s).themeDetails.title,id:"themeBtn",onClick:e[0]||(e[0]=(...i)=>n(s).changeTheme&&n(s).changeTheme(...i))},[a("div",ue,[a("img",{src:n(s).themeDetails.img},null,8,he)])],8,de)]),a("div",me,[n(s).authenticated&&n(s).signedUser.username!==""&&n(s).signedUser.username!==void 0?(h(),g("div",_e,pe)):(h(),g("div",ve,[a("button",{class:"google-button",onClick:e[1]||(e[1]=i=>U())},[fe,z(" Continue with Google ")])]))]),we]))}}});const xe=J(ye,[["__scopeId","data-v-d27720ee"]]);export{xe as default};
