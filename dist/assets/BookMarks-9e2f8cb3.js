import{d as q,a as $,r as v,u as H,o as F,x as I,c as u,f as d,g as a,F as M,y as z,k as T,h as A,z as V,w as C,n as O,t as L,i as Q,p as j,q as G,_ as J}from"./index-3c7daa31.js";import{u as K,a as W,P as X,R as Y,_ as Z,c as ee,d as te,g as oe,e as se}from"./useAuth.vue_vue_type_script_lang-0a2c6dcb.js";import{g as ne,r as ae,a as re}from"./index.esm2017-3ce07352.js";import{u as le}from"./useUserDetails.vue_vue_type_script_lang-f8979881.js";import{a as ce}from"./axios-4a70c6fc.js";import{c as ie,u as ue}from"./useDetailButtons-13ec496c.js";const de=m=>(j("data-v-793cdbba"),m=m(),G(),m),me=de(()=>a("h2",null,"Bookmarks",-1)),pe={class:"bookmarksCon"},he={key:0,class:V({resultsContainer:!0})},ge=["onClick"],fe={class:"result-item-other"},ve={class:"result-item-header"},ye=["onClick"],_e=["innerHTML","onClick"],ke={key:1,class:"noBookmarks"},we=q({__name:"BookMarks",setup(m){le(),$(()=>{const t=document.getElementById("warningShow");t.style.display="none"});const c=v(""),S=new DOMParser,{app:b}=K(),N=ne(b),p=W();p.sidebar=!1;const P=X(b),y=H(),_=v(!0),h=v([]),g=v();F(()=>{I(()=>{const t=document.getElementById("warningShow");t&&(t.style.display="flex",t.textContent="Loading ...")}),U(p.signedUser.bookmarks)});function D(t){y.push(`/post/${t}`)}function x(t){if(t===p.signedUser.id)return y.push("/userProfile");y.push(`/chatterUser/${t}`)}async function E(t){c.value="";try{const s=ae(N,t.postContain),o=await re(s).catch(e=>{console.log(e)});await ce.post("/postContent",{contentUrl:o}).then(e=>{const n=S.parseFromString(e.data,"text/html");c.value=n.body.innerHTML}).catch(e=>{console.log(e)})}catch{const o=document.querySelector("#ErrorShow span");o.style.display="flex",o.textContent="Something went wrong, check your internet connection"}}async function R(t){g.value=null;try{const s=oe(P,"users",t),o=await se(s);if(o.data()!==void 0){const{fullName:e,profilePicture:n,username:r,blogName:k}=o.data(),l={profilePicture:n,posterID:t,fullName:e,username:r,blogName:k};g.value={id:t,img:l.profilePicture,fullName:l.fullName,username:l.username,blogname:l.blogName}}}catch{}}async function U(t){try{const s=t.map(async n=>{const r=Y(Z(P,"posts"),ee("postId","==",n)),k=await te(r);return Promise.all(k.docs.map(async l=>{var B;const i=l.data();await E(i);const f=S.parseFromString(c.value,"text/html");return f.body.querySelectorAll("img").forEach(w=>{w.remove()}),f.body.querySelectorAll("video").forEach(w=>{w.remove()}),(B=f.body.querySelector("h1"))==null||B.remove(),c.value=f.body.innerHTML,i.postContain=c.value,await R(i.posterId),i.posterDetails=g.value,g.value=null,i}))}),e=(await Promise.all(s)).flat();h.value=e,_.value=!1,h.value&&I(()=>{const n=document.getElementById("warningShow");n&&(n.style.display="none")})}catch(s){console.log(s);const o=document.querySelector("#ErrorShow span");o.style.display="flex",o.textContent="Something went wrong, check your internet connection"}}return(t,s)=>{var o;return u(),d(M,null,[me,a("div",pe,[((o=h.value)==null?void 0:o.length)>0&&_.value===!1?(u(),d("div",he,[(u(!0),d(M,null,z(h.value,(e,n)=>(u(),d("div",{key:n,class:"result-item"},[a("div",{class:"imgCon",onClick:C(r=>x(e.posterId),["prevent"]),style:O({backgroundImage:`url(${e==null?void 0:e.posterDetails.img})`})},null,12,ge),a("div",fe,[a("div",ve,[a("span",{onClick:C(r=>x(e.posterId),["prevent"])},L(e==null?void 0:e.posterDetails.blogname),9,ye),a("span",null,L(ie(e.postTime.seconds)),1)]),a("div",{innerHTML:e.postContain,id:"divContent",onClick:C(r=>D(e.postId),["prevent"])},null,8,_e),Q(ue,{post:e},null,8,["post"])])]))),128))])):T("",!0),A(p).signedUser.bookmarks.length===0&&_.value===!1?(u(),d("div",ke," No Bookmarks yet. ")):T("",!0)])],64)}}});const Ie=J(we,[["__scopeId","data-v-793cdbba"]]);export{Ie as default};
