import{d as A,u as O,r as U,o as j,x as G,s as Q,a as J,b as K,c as d,e as W,f as u,g as e,w as k,h as t,n as X,t as i,i as w,j as D,z as b,l as p,k as C,F as Y,y as Z,p as ee,q as se,_ as te}from"./index-3c7daa31.js";import{a as oe,u as ne,P as ie,R as ae,_ as le,c as re,d as ce,g as de,e as ue}from"./useAuth.vue_vue_type_script_lang-0a2c6dcb.js";import{_ as pe}from"./useLoadingPage.vue_vue_type_style_index_0_lang-1a9153d1.js";import{g as me,r as _e,a as ge}from"./index.esm2017-3ce07352.js";import{u as he}from"./useUserDetails.vue_vue_type_script_lang-f8979881.js";import{S as fe}from"./useSignOut.vue_vue_type_script_lang-1b0773ff.js";import{c as ve,u as ye}from"./useDetailButtons-13ec496c.js";import{a as Ue}from"./axios-4a70c6fc.js";const l=f=>(ee("data-v-5a538431"),f=f(),se(),f),ke={key:1},we=["onClick"],be=["title"],Ce={id:"themeImgContainer"},Pe=["src"],Se={class:"body"},De={class:"imageCon"},Ie={class:"sectionFoImage"},Ne={class:"follow"},Te=l(()=>e("p",null,"||",-1)),Le={class:"btns"},Be=l(()=>e("button",null,"Edit Profile",-1)),Ee={class:"readerSec"},xe={class:"btnSection"},Re=l(()=>e("span",null,"Full Name:",-1)),$e=l(()=>e("span",null,"User Name:",-1)),Fe=l(()=>e("span",null,"Blog Name:",-1)),Me={key:0},qe=l(()=>e("span",null,"Biography:",-1)),He={key:1},Ve=l(()=>e("span",null,"Email:",-1)),ze=l(()=>e("span",null,"Location:",-1)),Ae=l(()=>e("span",null,"Birthday:",-1)),Oe=l(()=>e("span",null,"Gender:",-1)),je={key:2},Ge=l(()=>e("span",null,"Interests:",-1)),Qe={key:0,class:"loading"},Je={key:1},Ke={class:"type"},We={class:"result-item"},Xe=["src","alt","onClick"],Ye={class:"result-item-other"},Ze={class:"result-item-header"},es=["onClick"],ss=["innerHTML","onClick"],ts={id:"navigators"},os=l(()=>e("button",null,"Home",-1)),ns=l(()=>e("button",null,"Search",-1)),is=A({__name:"UserProfile",setup(f){const m=O(),I=U(!0),s=oe();j(()=>{he(),G(()=>{const n=document.getElementById("warningShow");n.style.display="none"}),s.section="personal"}),Q(()=>{s.signedUser.id!==void 0&&(I.value=!1)});const v=U(),{app:N}=ne(),$=me(N),T=ie(N),L=new DOMParser,h=U(""),B=U(!0);async function F(n){h.value="";const a=_e($,n.postContain),r=await ge(a).catch(o=>{console.log(o)});await Ue.post("/postContent",{contentUrl:r}).then(o=>{const _=L.parseFromString(o.data,"text/html");h.value=_.body.innerHTML}).catch(o=>{console.log(o)})}async function M(n){v.value=null;try{const a=de(T,"users",n),r=await ue(a);if(r.data()!==void 0){const{fullName:o,profilePicture:_,username:g,blogName:P}=r.data(),c={profilePicture:_,posterID:n,fullName:o,username:g,blogName:P};v.value={id:n,img:c.profilePicture,fullName:c.fullName,username:c.username,blogname:c.blogName}}}catch{}}async function q(n){if(n.length>0)try{const a=n.map(async o=>{const _=ae(le(T,"posts"),re("postId","==",o.details.postid)),g=await ce(_);return Promise.all(g.docs.map(async P=>{var R;const c=P.data();await F(c);const y=L.parseFromString(h.value,"text/html");return y.body.querySelectorAll("img").forEach(S=>{S.remove()}),y.body.querySelectorAll("video").forEach(S=>{S.remove()}),(R=y.body.querySelector("h1"))==null||R.remove(),h.value=y.body.innerHTML,c.postContain=h.value,await M(c.posterId),c.posterDetails=v.value,v.value=null,{type:o.type,postDetails:c}}))}),r=await Promise.all(a);s.signedUser.interactions=r.flat(),B.value=!1}catch{}else return}function H(){m.go(-1)}function E(n){s.section=n,n==="interaction"&&s.userId!==""&&s.userId!==void 0&&q(s.signedUser.interactions)}function V(n){m.push(`/post/${n}`)}function x(n){if(n===s.signedUser.id)return m.push("/userProfile");m.push(`/chatterUser/${n}`)}let z=setTimeout(()=>{s.signedUser.id===void 0&&s.authenticated===!1?m.push("/home"):s.authenticated===!0&&(s.signedUser.id===void 0&&s.signedUser.username===void 0?m.push({name:"NetworkError",query:{redirect:`${m.currentRoute.value.path}`}}):s.signedUser.id!==void 0&&s.signedUser.username===""&&(console.log("User registration not finished... Logging out user....."),fe(),s.authenticated=!1,m.push("/login")))},5e3);return J(()=>{clearTimeout(z);const n=document.getElementById("warningShow");n.style.display="none"}),(n,a)=>{const r=K("RouterLink");return I.value?(d(),W(pe,{key:0,"action-name":"Loading profile..."})):(d(),u("main",ke,[e("header",null,[e("button",{onClick:k(H,["prevent"])},"Back",8,we),e("button",{title:t(s).themeDetails.title,id:"themeBtn",onClick:a[0]||(a[0]=(...o)=>t(s).changeTheme&&t(s).changeTheme(...o))},[e("div",Ce,[e("img",{src:t(s).themeDetails.img},null,8,Pe)])],8,be)]),e("div",Se,[e("div",De,[e("div",{class:"imgCon",style:X({backgroundImage:`url(${t(s).signedUser.profilePicture})`})},null,4)]),e("section",Ie,[e("h3",null,i(t(s).signedUser.fullName),1),e("div",Ne,[e("p",null,i(t(s).signedUser.followers.total)+" Followers",1),Te,e("p",null,i(t(s).signedUser.following.total)+" Following",1)])]),e("div",Le,[w(r,{to:{name:"EditProfile"}},{default:D(()=>[Be]),_:1})]),e("div",Ee,[e("div",xe,[e("button",{onClick:a[1]||(a[1]=o=>E("personal")),class:b({active:t(s).section==="personal"})},"Personal",2),e("button",{onClick:a[2]||(a[2]=o=>E("interaction")),class:b({active:t(s).section==="interaction"})},"Interactions",2)]),e("div",{class:b({show:t(s).section==="personal",none:t(s).section!=="personal",personal:!0})},[e("p",null,[Re,p(" "+i(t(s).signedUser.fullName),1)]),e("p",null,[$e,p(" "+i(t(s).signedUser.username),1)]),e("p",null,[Fe,p(" "+i(t(s).signedUser.blogName),1)]),t(s).signedUser.bio.length>0?(d(),u("p",Me,[qe,p(" "+i(t(s).signedUser.bio),1)])):C("",!0),t(s).signedUser.settings.privacySettings.showEmail?(d(),u("p",He,[Ve,p(" "+i(t(s).signedUser.email),1)])):C("",!0),e("p",null,[ze,p(" "+i(t(s).signedUser.location),1)]),e("p",null,[Ae,p(" "+i(t(s).signedUser.dateOfBirth),1)]),e("p",null,[Oe,p(" "+i(t(s).signedUser.gender),1)]),t(s).signedUser.interests.length>0?(d(),u("p",je,[Ge,p(" "+i(t(s).signedUser.interests.join(",")),1)])):C("",!0)],2),t(s).section==="interaction"?(d(),u("div",{key:0,class:b({show:t(s).section==="interaction",none:t(s).section!=="interaction",interaction:!0})},[B.value?(d(),u("p",Qe,"Loading...")):(d(),u("div",Je,[(d(!0),u(Y,null,Z(t(s).signedUser.interactions,(o,_)=>(d(),u("div",{key:_},[e("div",Ke,i(o.type),1),e("div",We,[e("img",{src:o.postDetails.posterDetails.img,alt:o.postDetails.posterDetails.username+"profile picture",class:"result-item-image",onClick:k(g=>x(o.postDetails.posterId),["prevent"])},null,8,Xe),e("div",Ye,[e("div",Ze,[e("span",{onClick:k(g=>x(o.postDetails.posterId),["prevent"])},i(t(s).signedUser.blogName),9,es),e("span",null,i(ve(o.postDetails.postTime.seconds)),1)]),e("div",{innerHTML:o.postDetails.postContain,id:"divContent",onClick:k(g=>V(o.postDetails.postId),["prevent"])},null,8,ss),w(ye,{post:o.postDetails},null,8,["post"])])])]))),128))]))],2)):C("",!0)]),e("section",ts,[w(r,{to:"/home"},{default:D(()=>[os]),_:1}),w(r,{to:"/search"},{default:D(()=>[ns]),_:1})])])]))}}});const gs=te(is,[["__scopeId","data-v-5a538431"]]);export{gs as default};
