import{d as L,a as U,r as k,u as R,o as $,y as h,x as q,c as g,f as v,g as n,F as H,z as F,l as z,n as A,w as b,k as V,t as B,h as O,q as Q,s as j}from"./index-84880169.js";import{u as G,a as J}from"./useAuth.vue_vue_type_script_lang-1fcab594.js";import{P as K,R as W,_ as X,b as Y,d as Z,g as ee,c as te}from"./index.esm2017-9b22bd16.js";import{u as oe}from"./useUserDetails.vue_vue_type_script_lang-d0217ef7.js";import{a as se}from"./axios-4a70c6fc.js";import{u as ne}from"./useDetailButtons-11e0658c.js";import{c as ae}from"./useCalculateTime.vue_vue_type_script_lang-ca052a8e.js";import{_ as re}from"./_plugin-vue_export-helper-c27b6911.js";const I=u=>(Q("data-v-750df37b"),u=u(),j(),u),ie={class:"bookmarksPage"},le=I(()=>n("div",{id:"warningShow"},null,-1)),ce=I(()=>n("h2",null,"Bookmarks",-1)),de={class:"bookmarksCon"},ue={key:0,class:A({resultsContainer:!0})},me=["onClick"],pe={class:"result-item-other"},fe={class:"result-item-header"},he=["onClick"],ge=["innerHTML","onClick"],ve=L({__name:"BookMarks",setup(u){oe(),U(()=>{const e=document.getElementById("warningShow");e&&(e.style.display="none")});const d=k(""),C=new DOMParser,{app:M}=G(),m=J();m.sidebar=!1;const S=K(M),_=R(),i=k([]),p=k();$(()=>{h(()=>{const e=document.getElementById("warningShow");e&&(e.style.display="flex",e.textContent="Loading ...")}),D(m.signedUser.bookmarks)}),q(()=>{m.signedUser.bookmarks.length===0&&(i.value=[])});function T(e){_.push(`/post/${e}`)}function P(e){if(e===m.signedUser.id)return _.push("/userProfile");_.push(`/chatterUser/${e}`)}async function E(e){d.value="";const r=e.postContain;await se.post("/postContent",{contentUrl:r}).then(o=>{const t=C.parseFromString(o.data,"text/html");d.value=t.body.innerHTML})}async function N(e){p.value=null;const r=ee(S,"users",e),o=await te(r);if(o.data()!==void 0){const{fullName:t,profilePicture:s,username:l,blogName:y}=o.data(),c={profilePicture:s,posterID:e,fullName:t,username:l,blogName:y};p.value={id:e,img:c.profilePicture,fullName:c.fullName,username:c.username,blogname:c.blogName}}}async function D(e){try{const r=e.map(async s=>{const l=W(X(S,"posts"),Y("postId","==",s)),y=await Z(l);return Promise.all(y.docs.map(async c=>{var x;const a=c.data();if(a!=null&&a.length!==0){await E(a);const f=C.parseFromString(d.value,"text/html");return f.body.querySelectorAll("img").forEach(w=>{w.remove()}),f.body.querySelectorAll("video").forEach(w=>{w.remove()}),(x=f.body.querySelector("h1"))==null||x.remove(),d.value=f.body.innerHTML,a.postContain=d.value,await N(a.posterId),a.posterDetails=p.value,p.value=null,a}}))}),t=(await Promise.all(r)).flat();i.value=t,i.value.length>0&&h(()=>{const s=document.getElementById("warningShow");s&&(s.style.display="none")}),i.value.length===0&&h(()=>{const s=document.getElementById("warningShow");s&&(s.style.display="flex",s.textContent="No bookmarks yet")})}catch{h(()=>{const o=document.getElementById("warningShow");o&&(o.style.display="flex",o.textContent="Something went wrong, check your internet connection and reload page.")})}}return(e,r)=>{var o;return g(),v("section",ie,[le,ce,n("div",de,[((o=i.value)==null?void 0:o.length)>0?(g(),v("div",ue,[(g(!0),v(H,null,F(i.value,(t,s)=>(g(),v("div",{key:s,class:"result-item"},[n("div",{class:"imgCon",onClick:b(l=>P(t.posterId),["prevent"]),style:V({backgroundImage:`url(${t==null?void 0:t.posterDetails.img})`})},null,12,me),n("div",pe,[n("div",fe,[n("span",{onClick:b(l=>P(t.posterId),["prevent"])},B(t==null?void 0:t.posterDetails.blogname),9,he),n("span",null,B(ae(t.postTime.seconds)),1)]),n("div",{innerHTML:t.postContain,id:"divContent",onClick:b(l=>T(t.postId),["prevent"])},null,8,ge),O(ne,{post:t},null,8,["post"])])]))),128))])):z("",!0)])])}}});const xe=re(ve,[["__scopeId","data-v-750df37b"]]);export{xe as default};
