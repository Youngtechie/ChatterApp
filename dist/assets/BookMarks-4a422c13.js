import{d as q,a as H,r as y,u as F,o as z,x as I,c as u,f as d,g as n,F as M,y as A,k as E,h as V,z as O,w as C,n as Q,t as L,i as j,p as G,q as J,_ as K}from"./index-18dd88e0.js";import{u as W,a as X}from"./useAuth.vue_vue_type_script_lang-555f5ace.js";import{g as Y,r as Z,a as ee}from"./index.esm2017-df89f729.js";import{P as te,R as oe,_ as se,b as ne,d as ae,g as re,c as le}from"./index.esm2017-50856384.js";import{u as ie}from"./useUserDetails.vue_vue_type_script_lang-86cea6c9.js";import{a as ce}from"./axios-4a70c6fc.js";import{u as ue}from"./useDetailButtons-2387e954.js";import{c as de}from"./useCalculateTime.vue_vue_type_script_lang-ca052a8e.js";import"./useLikeButton-379588bc.js";const me=m=>(G("data-v-23403c32"),m=m(),J(),m),pe=me(()=>n("h2",null,"Bookmarks",-1)),ge={class:"bookmarksCon"},he={key:0,class:O({resultsContainer:!0})},ye=["onClick"],fe={class:"result-item-other"},ve={class:"result-item-header"},_e=["onClick"],ke=["innerHTML","onClick"],we={key:1,class:"noBookmarks"},Ce=q({__name:"BookMarks",setup(m){let p;H(()=>{clearTimeout(p);const e=document.getElementById("warningShow");e.style.display="none"});const i=y(""),S=new DOMParser;ie();const{app:b}=W(),N=Y(b),f=X(),P=te(b),v=F(),x=y(!0),_=y([]),g=y();z(()=>{clearTimeout(p),I(()=>{const e=document.getElementById("warningShow");e&&(e.style.display="flex",e.textContent="Loading ...")}),$(f.signedUser.bookmarks).finally(()=>{I(()=>{const e=document.getElementById("warningShow");e&&(e.style.display="none")})})});function D(e){v.push(`/post/${e}`)}function B(e){if(e===f.signedUser.id)return v.push("/userProfile");v.push(`/chatterUser/${e}`)}async function R(e){i.value="";try{const s=Z(N,e.postContain),o=await ee(s).catch(t=>{console.log(t)});await ce.post("/postContent",{contentUrl:o}).then(t=>{const a=S.parseFromString(t.data,"text/html");i.value=a.body.innerHTML}).catch(t=>{console.log(t)})}catch{const o=document.getElementById("ErrorShow");o.style.display="flex",o.textContent="Something went wrong, check your internet connection",p=setTimeout(()=>{o.style.display="none"},3e3)}}async function U(e){g.value=null;try{const s=re(P,"users",e),o=await le(s);if(o.data()!==void 0){const{fullName:t,profilePicture:a,username:r,blogName:k}=o.data(),l={profilePicture:a,posterID:e,fullName:t,username:r,blogName:k};g.value={id:e,img:l.profilePicture,fullName:l.fullName,username:l.username,blogname:l.blogName}}}catch{}}async function $(e){try{const s=e.map(async a=>{const r=oe(se(P,"posts"),ne("postId","==",a)),k=await ae(r);return Promise.all(k.docs.map(async l=>{var T;const c=l.data();await R(c);const h=S.parseFromString(i.value,"text/html");return h.body.querySelectorAll("img").forEach(w=>{w.remove()}),h.body.querySelectorAll("video").forEach(w=>{w.remove()}),(T=h.body.querySelector("h1"))==null||T.remove(),i.value=h.body.innerHTML,c.postContain=i.value,await U(c.posterId),c.posterDetails=g.value,g.value=null,x.value=!1,c}))}),t=(await Promise.all(s)).flat();_.value=t}catch(s){console.log(s);const o=document.getElementById("ErrorShow");o.style.display="flex",o.textContent="Something went wrong, check your internet connection",p=setTimeout(()=>{o.style.display="none"},3e3)}}return(e,s)=>{var o;return u(),d(M,null,[pe,n("div",ge,[((o=_.value)==null?void 0:o.length)>0&&x.value===!1?(u(),d("div",he,[(u(!0),d(M,null,A(_.value,(t,a)=>(u(),d("div",{key:a,class:"result-item"},[n("div",{class:"imgCon",onClick:C(r=>B(t.posterId),["prevent"]),style:Q({backgroundImage:`url(${t==null?void 0:t.posterDetails.img})`})},null,12,ye),n("div",fe,[n("div",ve,[n("span",{onClick:C(r=>B(t.posterId),["prevent"])},L(t==null?void 0:t.posterDetails.blogname),9,_e),n("span",null,L(de(t.postTime.seconds)),1)]),n("div",{innerHTML:t.postContain,id:"divContent",onClick:C(r=>D(t.postId),["prevent"])},null,8,ke),j(ue,{post:t},null,8,["post"])])]))),128))])):E("",!0),V(f).signedUser.bookmarks.length===0?(u(),d("div",we," No Bookmarks yet. ")):E("",!0)])],64)}}});const Le=K(Ce,[["__scopeId","data-v-23403c32"]]);export{Le as default};
