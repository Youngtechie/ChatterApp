import{d as U,r as m,u as q,o as H,x as b,s as z,a as A,c as p,f as g,F as V,y as Q,k as T,w as f,z as O,g as i,n as j,t as E,i as G,_ as J}from"./index-18dd88e0.js";import{u as K,a as W}from"./useAuth.vue_vue_type_script_lang-555f5ace.js";import{g as X,r as Y,a as Z}from"./index.esm2017-df89f729.js";import{P as ee,R as M,k as B,x as D,_ as I,d as te,g as oe,c as ne,F as se}from"./index.esm2017-50856384.js";import{u as ae}from"./useUserDetails.vue_vue_type_script_lang-86cea6c9.js";import{a as re}from"./axios-4a70c6fc.js";import{c as le}from"./useCalculateTime.vue_vue_type_script_lang-ca052a8e.js";import{u as ie}from"./useDetailButtons-2387e954.js";import"./useLikeButton-379588bc.js";const ce={class:"exploreSection"},ue={key:0,class:O({resultsContainer:!0})},de=["onClick"],me={class:"result-item-other"},pe={class:"result-item-header"},ge=["onClick"],ve=["innerHTML","onClick"],fe=["onClick"],he=U({__name:"ExplorePage",setup(_e){ae();const c=m([]),u=m(""),w=new DOMParser,h=q(),{app:C}=K(),L=X(C),_=ee(C),x=W();x.sidebar=!1;const d=m(null),v=m(),S=m(!0);H(()=>{b(()=>{const e=document.getElementById("warningShow");e&&(e.style.display="flex",e.textContent="Loading ...")}),d.value=M(I(_,"posts"),D("postTime","desc"),B(15)),k(d.value)});async function N(e){u.value="";try{const o=Y(L,e.postContain),n=await Z(o).catch(s=>{console.log(s)});await re.post("/postContent",{contentUrl:n}).then(s=>{const t=w.parseFromString(s.data,"text/html");u.value=t.body.innerHTML}).catch(s=>{console.log(s)})}catch{const n=document.getElementById("ErrorShow");n.style.display="flex",n.textContent="Something went wrong, check your internet connection and reload page"}}async function R(e){v.value=null;try{const o=oe(_,"users",e),n=await ne(o);if(n.data()!==void 0){const{fullName:s,profilePicture:t,username:a,blogName:r}=n.data(),l={profilePicture:t,posterID:e,fullName:s,username:a,blogName:r};v.value={id:e,img:l.profilePicture,fullName:l.fullName,username:l.username,blogname:l.blogName}}}catch{}}async function k(e){const n=(await te(e)).docs.map(async t=>{var l;const a=t.data();await N(a);const r=w.parseFromString(u.value,"text/html");return r.body.querySelectorAll("img").forEach(y=>{y.remove()}),r.body.querySelectorAll("video").forEach(y=>{y.remove()}),(l=r.body.querySelector("h1"))==null||l.remove(),u.value=r.body.innerHTML,a.postContain=u.value,await R(a.posterId),a.posterDetails=v.value,a}),s=await Promise.all(n);c.value=s,v.value=null,S.value=!1}function $(){const e=d.value.docs[d.value.docs.length-1],o=M(I(_,"cities"),D("postTime","desc"),se(e),B(15));k(o).then(()=>{d.value=o})}function F(e){h.push(`/post/${e}`)}function P(e){if(e===x.signedUser.id)return h.push("/userProfile");h.push(`/chatterUser/${e}`)}return z(()=>{var e;((e=c.value)==null?void 0:e.length)>0&&b(()=>{const o=document.getElementById("warningShow");o&&(o.style.display="none")})}),A(()=>{const e=document.getElementById("warningShow");e.style.display="none"}),(e,o)=>{var n,s;return p(),g("main",ce,[((n=c.value)==null?void 0:n.length)>0&&S.value===!1?(p(),g("div",ue,[(p(!0),g(V,null,Q(c.value,(t,a)=>(p(),g("div",{key:a,class:"result-item"},[i("div",{class:"imgCon",onClick:f(r=>P(t.posterId),["prevent"]),style:j({backgroundImage:`url(${t==null?void 0:t.posterDetails.img})`})},null,12,de),i("div",me,[i("div",pe,[i("span",{onClick:f(r=>P(t.posterId),["prevent"])},E(t==null?void 0:t.posterDetails.blogname),9,ge),i("span",null,E(le(t.postTime.seconds)),1)]),i("div",{innerHTML:t.postContain,id:"divContent",onClick:f(r=>F(t.postId),["prevent"])},null,8,ve),G(ie,{post:t},null,8,["post"])])]))),128))])):T("",!0),((s=c.value)==null?void 0:s.length)===15?(p(),g("button",{key:1,onClick:f($,["prevent"])},"See More ....",8,fe)):T("",!0)])}}});const Ee=J(he,[["__scopeId","data-v-99de8ac5"]]);export{Ee as default};
