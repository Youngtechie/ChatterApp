import{d as L,a as U,r as k,u as R,o as $,y as g,x as q,c as f,f as v,g as n,F as H,z as F,l as z,n as A,w as b,k as V,t as B,h as O,q as Q,s as j,_ as G}from"./index-36d15da9.js";import{u as J,a as K}from"./useAuth.vue_vue_type_script_lang-0f4a9525.js";import{P as W,R as X,_ as Y,b as Z,d as ee,g as te,c as oe}from"./index.esm2017-8a8714eb.js";import{u as se}from"./useUserDetails.vue_vue_type_script_lang-3df38338.js";import{a as ne}from"./axios-4a70c6fc.js";import{u as ae}from"./useDetailButtons-29f69ecb.js";import{c as re}from"./useCalculateTime.vue_vue_type_script_lang-ca052a8e.js";const I=u=>(Q("data-v-0b7b8b70"),u=u(),j(),u),ie={class:"bookmarksPage"},le=I(()=>n("div",{id:"warningShow"},null,-1)),ce=I(()=>n("h2",null,"Bookmarks",-1)),de={class:"bookmarksCon"},ue={key:0,class:A({resultsContainer:!0})},me=["onClick"],pe={class:"result-item-other"},he={class:"result-item-header"},ge=["onClick"],fe=["innerHTML","onClick"],ve=L({__name:"BookMarks",setup(u){se(),U(()=>{const e=document.getElementById("warningShow");e.style.display="none"});const c=k(""),C=new DOMParser,{app:M}=J(),m=K();m.sidebar=!1;const S=W(M),_=R(),r=k([]),p=k();$(()=>{g(()=>{const e=document.getElementById("warningShow");e&&(e.style.display="flex",e.textContent="Loading ...")}),D(m.signedUser.bookmarks)}),q(()=>{m.signedUser.bookmarks.length===0&&(r.value=[])});function T(e){_.push(`/post/${e}`)}function P(e){if(e===m.signedUser.id)return _.push("/userProfile");_.push(`/chatterUser/${e}`)}async function E(e){c.value="";const a=e.postContain;await ne.post("/postContent",{contentUrl:a}).then(o=>{const t=C.parseFromString(o.data,"text/html");c.value=t.body.innerHTML})}async function N(e){p.value=null;const a=te(S,"users",e),o=await oe(a);if(o.data()!==void 0){const{fullName:t,profilePicture:s,username:i,blogName:y}=o.data(),l={profilePicture:s,posterID:e,fullName:t,username:i,blogName:y};p.value={id:e,img:l.profilePicture,fullName:l.fullName,username:l.username,blogname:l.blogName}}}async function D(e){try{const a=e.map(async s=>{const i=X(Y(S,"posts"),Z("postId","==",s)),y=await ee(i);return Promise.all(y.docs.map(async l=>{var x;const d=l.data();await E(d);const h=C.parseFromString(c.value,"text/html");return h.body.querySelectorAll("img").forEach(w=>{w.remove()}),h.body.querySelectorAll("video").forEach(w=>{w.remove()}),(x=h.body.querySelector("h1"))==null||x.remove(),c.value=h.body.innerHTML,d.postContain=c.value,await N(d.posterId),d.posterDetails=p.value,p.value=null,d}))}),t=(await Promise.all(a)).flat();r.value=t,r.value.length>0&&g(()=>{const s=document.getElementById("warningShow");s&&(s.style.display="none")}),r.value.length===0&&g(()=>{const s=document.getElementById("warningShow");s&&(s.style.display="flex",s.textContent="No bookmarks yet")})}catch{g(()=>{const o=document.getElementById("warningShow");o&&(o.style.display="flex",o.textContent="Something went wrong, check your internet connection and reload page.")})}}return(e,a)=>{var o;return f(),v("section",ie,[le,ce,n("div",de,[((o=r.value)==null?void 0:o.length)>0?(f(),v("div",ue,[(f(!0),v(H,null,F(r.value,(t,s)=>(f(),v("div",{key:s,class:"result-item"},[n("div",{class:"imgCon",onClick:b(i=>P(t.posterId),["prevent"]),style:V({backgroundImage:`url(${t==null?void 0:t.posterDetails.img})`})},null,12,me),n("div",pe,[n("div",he,[n("span",{onClick:b(i=>P(t.posterId),["prevent"])},B(t==null?void 0:t.posterDetails.blogname),9,ge),n("span",null,B(re(t.postTime.seconds)),1)]),n("div",{innerHTML:t.postContain,id:"divContent",onClick:b(i=>T(t.postId),["prevent"])},null,8,fe),O(ae,{post:t},null,8,["post"])])]))),128))])):z("",!0)])])}}});const Pe=G(ve,[["__scopeId","data-v-0b7b8b70"]]);export{Pe as default};
