import{d as F,a as A,r as y,u as V,q as O,o as z,s as I,c as v,f as _,F as E,x as Q,k as j,y as G,g as i,w as C,t as M,i as J,p as K,n as W,_ as X}from"./index-f1eab0dd.js";import{u as Y,a as Z}from"./useAuth.vue_vue_type_script_lang-298818ca.js";import{g as N,r as D,a as L}from"./index.esm2017-9ddf60ae.js";import{P as ee,R as te,_ as oe,b as ne,d as se,g as ae,c as re}from"./index.esm2017-96b642a7.js";import{u as le}from"./useUserDetails.vue_vue_type_script_lang-3dc9a373.js";import{a as ie}from"./axios-4a70c6fc.js";import{u as ce}from"./useDetailButtons-7e4732f0.js";import{c as ue}from"./useCalculateTime.vue_vue_type_script_lang-ca052a8e.js";import"./useLikeButton-b22feb4d.js";const me=f=>(K("data-v-69164c00"),f=f(),W(),f),de=me(()=>i("h2",null,"Bookmarks",-1)),pe={key:0,class:G({resultsContainer:!0})},fe=["src","alt","onClick"],ge={class:"result-item-other"},he={class:"result-item-header"},ye=["onClick"],ve=["innerHTML","onClick"],_e=F({__name:"BookMarks",setup(f){let m;A(()=>{clearTimeout(m)});const d=y(""),S=new DOMParser;le();const{app:P}=Y(),R=N(P),x=Z(),b=ee(P),w=V(),T=y(!0),g=y([]),h=y();O(()=>{var t;((t=g.value)==null?void 0:t.length)>0&&I(()=>{const n=document.getElementById("warningShow");n&&(n.style.display="none")})}),z(()=>{clearTimeout(m),I(()=>{const t=document.getElementById("warningShow");t&&(t.style.display="flex",t.textContent="Loading ...")}),H(x.signedUser.bookmarks)});function U(t){w.push(`/post/${t}`)}function B(t){if(t===x.signedUser.id)return w.push("/userProfile");w.push(`/chatterUser/${t}`)}async function $(t){d.value="";try{const n=D(R,t.postContain),o=await L(n).catch(e=>{console.log(e)});await ie.post("/postContent",{contentUrl:o}).then(e=>{const a=S.parseFromString(e.data,"text/html");d.value=a.body.innerHTML}).catch(e=>{console.log(e)})}catch{const o=document.getElementById("ErrorShow");o.style.display="flex",o.textContent="Something went wrong, check your internet connection",m=setTimeout(()=>{o.style.display="none"},3e3)}}async function q(t){h.value=null;try{const n=ae(b,"users",t),o=await re(n);if(o.data()!==void 0){const{fullName:e,profilePicture:a,username:c,blogName:k}=o.data(),s={profilePicture:a,posterID:t,fullName:e,username:c,blogName:k},r=N(),u=D(r,s.profilePicture);try{await L(u).then(p=>{s.profilePicture&&(s.profilePicture=p),s.blogName===""&&(s.blogName=`${s.username}Blog`),h.value={id:t,img:s.profilePicture,fullName:s.fullName,username:s.username,blogname:s.blogName}})}catch{const l=document.getElementById("ErrorShow");l.style.display="flex",l.textContent="Something went wrong, check your internet connection",m=setTimeout(()=>{l.style.display="none"},3e3)}}}catch{}}async function H(t){try{const n=t.map(async a=>{const c=te(oe(b,"posts"),ne("postId","==",a)),k=await se(c);return Promise.all(k.docs.map(async s=>{var p;const r=s.data();await $(r);const u=S.parseFromString(d.value,"text/html");return u.body.querySelectorAll("img").forEach(l=>{l.remove()}),u.body.querySelectorAll("video").forEach(l=>{l.remove()}),(p=u.body.querySelector("h1"))==null||p.remove(),d.value=u.body.innerHTML,r.postContain=d.value,await q(r.posterId),r.posterDetails=h.value,h.value=null,T.value=!1,r}))}),e=(await Promise.all(n)).flat();g.value=e}catch(n){console.log(n);const o=document.getElementById("ErrorShow");o.style.display="flex",o.textContent="Something went wrong, check your internet connection",m=setTimeout(()=>{o.style.display="none"},3e3)}}return(t,n)=>{var o;return v(),_(E,null,[de,((o=g.value)==null?void 0:o.length)>0&&T.value===!1?(v(),_("div",pe,[(v(!0),_(E,null,Q(g.value,(e,a)=>(v(),_("div",{key:a,class:"result-item"},[i("img",{src:e==null?void 0:e.posterDetails.img,alt:(e==null?void 0:e.posterDetails.username)+"profile picture",class:"result-item-image",onClick:C(c=>B(e.posterId),["prevent"])},null,8,fe),i("div",ge,[i("div",he,[i("span",{onClick:C(c=>B(e.posterId),["prevent"])},M(e==null?void 0:e.posterDetails.blogname),9,ye),i("span",null,M(ue(e.postTime.seconds)),1)]),i("div",{innerHTML:e.postContain,id:"divContent",onClick:C(c=>U(e.postId),["prevent"])},null,8,ve),J(ce,{post:e},null,8,["post"])])]))),128))])):j("",!0)],64)}}});const Ie=X(_e,[["__scopeId","data-v-69164c00"]]);export{Ie as default};
